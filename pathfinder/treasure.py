#!/usr/bin/env python
# -*- coding: utf-8 -*-
'''Generate some random magic items for Pathfinder RPG.

Author: Norman J. Harman Jr. <njharman@gmail.com>
Website: http://trollandflame.blogspot.com/

This software uses trademarks and/or copyrights owned by Paizo Publishing, LLC,
which are used under Paizo's Community Use Policy. We are expressly prohibited
from charging you to use or access this content. This software is not published,
endorsed, or specifically approved by Paizo Publishing. For more information
about Paizo's Community Use Policy, please visit paizo.com/communityuse. For
more information about Paizo Publishing and Paizo products, please visit
paizo.com.

http://paizo.com/paizo/about/communityuse

OPEN GAME LICENSE

Version 1.0a The following text is the property of Wizards of the Coast, Inc. and is Copyright 2000 Wizards of the Coast, Inc ("Wizards").  All Rights Reserved.

    (1. Definitions: (a)"Contributors" means the copyright and/or trademark owners who have contributed Open Game Content; (b)"Derivative Material" means copyrighted material including derivative works and translations (including into other computer languages), potation, modification, correction, addition, extension, upgrade, improvement, compilation, abridgment or other form in which an existing work may be recast, transformed or adapted; (c) "Distribute" means to reproduce, license, rent, lease, sell, broadcast, publicly display, transmit or otherwise distribute; (d)"Open Game Content" means the game mechanic and includes the methods, procedures, processes and routines to the extent such content does not embody the Product Identity and is an enhancement over the prior art and any additional content clearly identified as Open Game Content by the Contributor, and means any work covered by this License, including translations and derivative works under copyright law, but specifically excludes Product Identity. (e) "Product Identity" means product and product line names, logos and identifying marks including trade dress; artifacts; creatures characters; stories, storylines, plots, thematic elements, dialogue, incidents, language, artwork, symbols, designs, depictions, likenesses, formats, poses, concepts, themes and graphic, photographic and other visual or audio representations; names and descriptions of characters, spells, enchantments, personalities, teams, personas, likenesses and special abilities; places, locations, environments, creatures, equipment, magical or supernatural abilities or effects, logos, symbols, or graphic designs; and any other trademark or registered trademark clearly identified as Product identity by the owner of the Product Identity, and which specifically excludes the Open Game Content; (f) "Trademark" means the logos, names, mark, sign, motto, designs that are used by a Contributor to identify itself or its products or the associated products contributed to the Open Game License by the Contributor (g) "Use", "Used" or "Using" means to use, Distribute, copy, edit, format, modify, translate and otherwise create Derivative Material of Open Game Content. (h) "You" or "Your" means the licensee in terms of this agreement.
    (2. The License: This License applies to any Open Game Content that contains a notice indicating that the Open Game Content may only be Used under and in terms of this License. You must affix such a notice to any Open Game Content that you Use. No terms may be added to or subtracted from this License except as described by the License itself.  No other terms or conditions may be applied to any Open Game Content distributed using this License.
    (3. Offer and Acceptance: By Using the Open Game Content You indicate Your acceptance of the terms of this License.
    (4. Grant and Consideration: In consideration for agreeing to use this License, the Contributors grant You a perpetual, worldwide, royalty-free, non-exclusive license with the exact terms of this License to Use, the Open Game Content.
    (5. Representation of Authority to Contribute: If You are contributing original material as Open Game Content, You represent that Your Contributions are Your original creation and/or You have sufficient rights to grant the rights conveyed by this License.
    (6. Notice of License Copyright: You must update the COPYRIGHT NOTICE portion of this License to include the exact text of the COPYRIGHT NOTICE of any Open Game Content You are copying, modifying or distributing, and You must add the title, the copyright date, and the copyright holder's name to the COPYRIGHT NOTICE of any original Open Game Content you Distribute.
    (7. Use of Product Identity: You agree not to Use any Product Identity, including as an indication as to compatibility, except as expressly licensed in another, independent Agreement with the owner of each element of that Product Identity. You agree not to indicate compatibility or co-adaptability with any Trademark or Registered Trademark in conjunction with a work containing Open Game Content except as expressly licensed in another, independent Agreement with the owner of such Trademark or Registered Trademark.  The use of any Product Identity in Open Game Content does not constitute a challenge to the ownership of that Product Identity. The owner of any Product Identity used in Open Game Content shall retain all rights, title and interest in and to that Product Identity.
    (8. Identification: If you distribute Open Game Content You must clearly indicate which portions of the work that you are distributing are Open Game Content.
    (9. Updating the License: Wizards or its designated Agents may publish updated versions of this License. You may use any authorized version of this License to copy, modify and distribute any Open Game Content originally distributed under any version of this License.
    (10. Copy of this License: You MUST include a copy of this License with every copy of the Open Game Content You Distribute.
    (11. Use of Contributor Credits: You may not market or advertise the Open Game Content using the name of any Contributor unless You have written permission from the Contributor to do so.
    (12. Inability to Comply: If it is impossible for You to comply with any of the terms of this License with respect to some or all of the Open Game Content due to statute, judicial order, or governmental regulation then You may not Use any Open Game Material so affected.
    (13. Termination: This License will terminate automatically if You fail to comply with all terms herein and fail to cure such breach within 30 days of becoming aware of the breach.  All sublicenses shall survive the termination of this License.
    (14. Reformation: If any provision of this License is held to be unenforceable, such provision shall be reformed only to the extent necessary to make it enforceable.
    (15. COPYRIGHT NOTICE
Open Game License v 1.0a Copyright 2000, Wizards of the Coast, Inc.
System Reference Document. Copyright 2000, Wizards of the Coast, Inc.; Authors Jonathan Tweet, Monte Cook, Skip Williams, based on material by E. Gary Gygax and Dave Arneson.
Pathfinder Roleplaying Game Reference Document. © 2011, Paizo Publishing, LLC; Author: Paizo Publishing, LLC.
Pathfinder Roleplaying Game Core Rulebook. © 2009, Paizo Publishing, LLC; Author: Jason Bulmahn, based on material by Jonathan Tweet, Monte Cook, and Skip Williams.
Pathfinder Roleplaying Game Ultimate Equipment. © 2012 Paizo Publishing, LLC; Authors: Dennis Baker, Jesse Benner, Benjamin Bruck, Ross Byers, Brian J. Cortijo, Ryan Costello, Mike Ferguson, Matt Goetz, Jim Groves, Tracy Hurley, Matt James, Jonathan H. Keith, Michael Kenway, Hal MacLean, Jason Nelson, Tork Shaw, Owen KC Stephens, and Russ Taylor.
'''

import re
import random

import app


lmin_special_armor = [
    (50, 'Mithral Shirt (1,100gp)'),
    (100, 'Masterwork Armor or special materials'),
    ]
gmin_special_armor = [
    (33, 'Mistmail (2,250gp)'),
    (66, 'Otyugh Hide (2,565gp)'),
    (100, 'Dragonhide Plate (3,300gp)'),
    ]
lmed_special_armor = [
    (33, 'Elven Chain (5,150gp)'),
    (66, 'Rhino Hide (5,165gp)'),
    (100, 'Morlock Hide (8,910gp)'),
    ]
gmed_special_armor = [
    (15, 'Adamantine Breastplate (10,200gp)'),
    (25, 'Soothsayer\'s Raiment (10,300gp)'),
    (38, 'Equestrian Plate (10,650gp)'),
    (50, 'Enchanted Eelskin (11,160gp)'),
    (62, 'Boneless Leather (12,160gp)'),
    (72, 'Murderer\'s Blackcloth (12,405gp)'),
    (86, 'Folding Plate (12,650gp)'),
    (100, 'Breastplate of Vanishing (15,200gp)'),
    ]
lmaj_special_armor = [
    (13, 'Armor of Insults (16,175gp)'),
    (29, 'Dwarven Plate (16,500gp)'),
    (45, 'Banded Mail of Luck (18,900gp)'),
    (58, 'Catskin Leather (18,910gp)'),
    (71, 'Celestial Armor (22,400gp)'),
    (84, 'Buccaneer\'s Breastplate (23,850gp)'),
    (100, 'Plate Armor of the Deep (24,650gp)'),
    ]
gmaj_special_armor = [
    (10, 'Breastplate of Command (25,400gp)'),
    (14, 'Forsaken Banded Mail (25,400gp)'),
    (24, 'Mithral Full Plate of Speed (26,500gp)'),
    (28, 'Warden of the Woods (29,350gp)'),
    (32, 'Scarab Breastplate (32,350gp)'),
    (38, 'Giant-hide Armor (ogre) (39,165gp)'),
    (42, 'Hamatula Hide (44,215gp)'),
    (48, 'Giant-hide Armor (hill giant) (46,665gp)'),
    (52, 'Demon Armor (52,260gp)'),
    (58, 'Giant-hide Armor (stone, fire, or frost giant) (54,165gp)'),
    (64, 'Giant-hide Armor (troll) (59,165gp)'),
    (70, 'Mail of Malevolence (61,300gp)'),
    (76, 'Giant-hide Armor (cloud giant) (69,165gp)'),
    (82, 'Giant-hide Armor (storm giant) (76,665gp)'),
    (88, 'Daystar Half-plate (81,250gp)'),
    (96, 'Invincible Armor (137,650gp)'),
    (100, 'Prismatic Plate (160,650gp)'),
    ]

lmin_armor = [
    (80, '+1 armor or shield (1000gp)'),
    (100, lambda: roll(lmin_special_armor)),
    ]
gmin_armor = [
    (26, '+1 armor or shield (1,000gp)'),
    (53, '+2 armor or shield (4,000gp)'),
    (80, '+1 armor or shield with one +1 special ability (4,000gp)'),
    (100, lambda: roll(gmin_special_armor)),
    ]
lmed_armor = [
    (10, '+1 armor or shield (1,000gp)'),
    (20, '+2 armor or shield (4,000gp)'),
    (32, '+3 armor or shield (9,000gp)'),
    (44, '+1 armor or shield with one +1 special ability (4,000gp)'),
    (56, '+1 armor or shield with two +1 special abilities (9,000gp)'),
    (68, '+1 armor or shield with one +2 special ability (9,000gp)'),
    (80, '+2 armor or shield with one +1 special ability (9,000gp)'),
    (100, lambda: roll(lmed_special_armor)),
    ]
gmed_armor = [
    (10, '+2 armor or shield (4,000gp)'),
    (22, '+3 armor or shield (9,000gp)'),
    (32, '+1 armor or shield with one +1 special ability (4,000gp)'),
    (44, '+1 armor or shield with one +2 special ability (9,000gp)'),
    (56, '+2 armor or shield with one +1 special ability (9,000gp)'),
    (68, '+2 armor or shield with one +2 special ability (16,000gp)'),
    (80, '+3 armor or shield with one +1 special ability (16,000gp)'),
    (100, lambda: roll(gmed_special_armor)),
    ]
lmaj_armor = [
    (10, '+3 armor or shield (9,000gp)'),
    (22, '+4 armor or shield (16,000gp)'),
    (32, '+1 armor or shield with one +2 special ability (9,000gp)'),
    (44, '+1 armor or shield with one +3 special ability (16,000gp)'),
    (56, '+2 armor or shield with one +2 special ability (16,000gp)'),
    (68, '+3 armor or shield with one +1 special ability (16,000gp)'),
    (80, '+4 armor or shield with one +1 special ability (25,000gp)'),
    (100, lambda: roll(lmaj_special_armor)),
    ]
gmaj_armor = [
    (10, '+4 armor or shield (16,000gp)'),
    (20, '+5 armor or shield (25,000gp)'),
    (30, '+4 armor or shield with one +1 special ability (25,000gp)'),
    (38, '+4 armor or shield with one +2 special ability (36,000gp)'),
    (46, '+4 armor or shield with one +3 special ability (49,000gp)'),
    (51, '+4 armor or shield with one +4 special ability (64,000gp)'),
    (59, '+5 armor or shield with one +1 special ability (36,000gp)'),
    (67, '+5 armor or shield with one +2 special ability (49,000gp)'),
    (71, '+5 armor or shield with one +3 special ability (64,000gp)'),
    (74, '+5 armor or shield with two +2 special abilities (81,000gp)'),
    (77, '+5 armor or shield with one +4 special ability (81,000gp)'),
    (80, '+5 armor or shield with one +5 special ability (100,000gp)'),
    (100, lambda: roll(gmaj_special_armor)),
    ]
armor_type = [
    (4, 'Banded Mail'),
    (11, 'Breastplate'),
    (14, 'Buckler'),
    (21, 'Chain Shirt'),
    (27, 'Chainmail'),
    (34, 'Full Plate'),
    (39, 'Half-plate'),
    (45, 'Heavy Steel Shield'),
    (51, 'Heavy Wooden Shield'),
    (55, 'Hide'),
    (61, 'Leather Armor'),
    (65, 'Light Steel Shield'),
    (69, 'Light Wooden Shield'),
    (72, 'Padded Armor'),
    (77, 'Scale Mail'),
    (81, 'Splint Mail'),
    (87, 'Studded Leather Armor'),
    (90, 'Tower Shield'),
    (93, 'Other Light Armor'),
    (95, 'Other Medium Armor'),
    (98, 'Other heavy Armor'),
    (100, 'Other Shield'),
    ]


def armornator(*pair):
    def inner():
        type = roll(armor_type)
        return recurse(zip((66, 100), pair)).replace('armor or shield', type)
    return inner

armor = (
        armornator(lmin_armor, gmin_armor),
        armornator(lmed_armor, gmed_armor),
        armornator(lmaj_armor, gmaj_armor),
        )

lmin_special_weapon = [
    (2, 'Tracer Bullet (100gp)'),
    (8, 'Sleep Arrow (132gp)'),
    (10, 'Dustburst Bullet (196gp)'),
    (16, 'Tangle Bolt (226gp)'),
    (22, 'Screaming Bolt (267gp)'),
    (32, 'Masterwork Silver Dagger (322gp)'),
    (34, 'Alchemist\'s Bullet (330gp)'),
    (44, 'Cold Iron Masterwork Longsword (330gp)'),
    (50, 'Hushing Arrow (547gp)'),
    (56, 'Hushing Arrow, Greater (1,047gp)'),
    (66, 'Javelin of Lightning (1,500gp)'),
    (74, 'Searing Arrow (1,516gp)'),
    (82, 'Sizzling Arrow (1,516gp)'),
    (84, 'Burrowing Bullet, Lesser (1,722gp)'),
    (92, 'Dust Bolt (1,730gp)'),
    (100, 'Slaying Arrow (2,282gp)'),
    ]
gmin_special_weapon = [
    (20, 'Adamantine Dagger (3,002gp)'),
    (40, 'Adamantine Battleaxe (3,010gp)'),
    (50, 'Burrowing Bullet, Greater (3,447gp)'),
    (70, 'Slaying Arrow, Greater (4,057gp)'),
    (80, 'Lance of Jousting (4,310gp)'),
    (100, 'Shatterspike (4,315gp)'),
    ]
lmed_special_weapon = [
    (3, 'Bloodletting Kukri (6,308gp)'),
    (9, 'Boulderhead Mace (6,812gp)'),
    (14, 'Beaststrike Club (7,300gp)'),
    (20, 'Fighter\'s Fork (7,315gp)'),
    (23, 'Everflowing Aspergillum (7,805gp)'),
    (28, 'Hurricane Quarterstaff (7,840gp)'),
    (34, 'Dagger of Venom (8,302gp)'),
    (39, 'Gloom Blade (8,810gp)'),
    (44, 'Frostbite Sling (9,380gp)'),
    (49, 'Trident of Stability (9,815gp)'),
    (54, 'Trident of Warning (10,115gp)'),
    (60, 'Assassin\'s Dagger (10,302gp)'),
    (66, 'Dagger of Doubling (10,302gp)'),
    (71, 'Earthenflail (11,315gp)'),
    (79, 'Swift Obsidian Greataxe (11,320gp)'),
    (85, 'Polarity Hammer (12,310gp)'),
    (93, 'Blade of Binding (12,350gp)'),
    (100, 'Shifter\'s Sorrow (12,780gp)'),
    ]
gmed_special_weapon = [
    (7, 'Dragoncatch Guisarme (13,308gp)'),
    (15, 'Ten-ring Sword (14,315gp)'),
    (21, 'Triton\'s Trident (15,065gp)'),
    (29, 'Mace of Smiting, Lesser (16,012gp)'),
    (37, 'Disarming Blade (17,820gp)'),
    (42, 'Lash of the Howler (18,305gp)'),
    (47, 'Shieldsplitter Lance (18,310gp)'),
    (53, 'Trident of Fish Command (18,650gp)'),
    (59, 'Quarterstaff of Vaulting (19,100gp)'),
    (65, 'Firedrake Pistol (20,300gp)'),
    (71, 'Ricochet Hammer (20,301gp)'),
    (77, 'Flame Tongue (20,715gp)'),
    (85, 'Sparkwake Starknife (21,324gp)'),
    (90, 'Luck blade (0 wishes) (22,060gp)'),
    (95, 'Sword of Subtlety (22,310gp)'),
    (100, 'Sword of the Planes (22,315gp)'),
    ]
lmaj_special_weapon = [
    (12, 'Nine Lives Stealer (23,057gp)'),
    (26, 'Undercutting Axe (23,310gp)'),
    (40, 'Spirit Caller (25,302gp)'),
    (55, 'Dwarfbond Hammer (25,312gp)'),
    (70, 'Oathbow (25,600gp)'),
    (85, 'Sword of Life Stealing (25,715gp)'),
    (100, 'Cutthroat\'s Apprentice (33,910gp)'),
    ]
gmaj_special_weapon = [
    (2, 'Ghoul\'s Lament (35,312gp)'),
    (5, 'Mace of Terror (38,552gp)'),
    (7, 'Hellscourge (39,305gp)'),
    (9, 'Dragon\'s Doom (40,310gp)'),
    (13, 'Life-drinker (40,320gp)'),
    (16, 'Valor\'s Minion (41,335gp)'),
    (18, 'Summoner\'s Sorrow (42,816gp)'),
    (21, 'Sylvan Scimitar (47,315gp)'),
    (23, 'Spirit Blade (48,502gp)'),
    (26, 'Heartswood Spear (50,302gp)'),
    (29, 'Rapier of Puncturing (50,320gp)'),
    (32, 'Sun Blade (50,335gp)'),
    (37, 'Blade of the Rising Sun (51,850gp)'),
    (40, 'Frost Brand (54,475gp)'),
    (45, 'Dwarven Thrower (60,312gp)'),
    (50, 'Bloodthirst Dagger (60,802gp)'),
    (53, 'Warbringer (61,375gp)'),
    (57, 'Luck Blade (1 wish) (62,360gp)'),
    (61, 'Guarding Blade (65,310gp)'),
    (64, 'Pistol of the Infinite Sky (73,300gp)'),
    (69, 'Mace of Smiting (75,312gp)'),
    (73, 'Blade of the Sword-saint (75,350gp)'),
    (76, 'Scimitar of the Spellthief (75,815gp)'),
    (79, 'Spider\'s Fang (79,102gp)'),
    (82, 'Demonsorrow Curve Blade (90,469gp)'),
    (85, 'Void Scythe (95,318gp)'),
    (89, 'Luck Blade (2 wishes) (102,660gp)'),
    (92, 'Holy Avenger (120,630gp)'),
    (96, 'Bastard\'s Sting (123,035gp)'),
    (100, 'Luck blade (3 wishes) (142,960gp)'),
    ]
lmin_weapon = [
    (80, '+1 weapon (2,000gp)'),
    (100, lambda: roll(lmin_special_weapon)),
    ]
gmin_weapon = [
    (26, '+1 weapon (2,000gp)'),
    (53, '+2 weapon (8,000gp)'),
    (80, '+1 weapon with one +1 special ability (8,000gp)'),
    (100, lambda: roll(gmin_special_weapon)),
    ]
lmed_weapon = [
    (10, '+1 weapon (2,000gp)'),
    (20, '+2 weapon (8,000gp)'),
    (32, '+3 weapon (18,000gp)'),
    (44, '+1 weapon with one +1 special ability (8,000gp)'),
    (56, '+1 weapon with two +1 special abilities (18,000gp)'),
    (68, '+1 weapon with one +2 special ability (18,000gp)'),
    (80, '+2 weapon with one +1 special ability (18,000gp)'),
    (100, lambda: roll(lmed_special_weapon)),
    ]
gmed_weapon = [
    (10, '+2 weapon (8,000gp)'),
    (22, '+3 weapon (18,000gp)'),
    (32, '+1 weapon with one +1 special ability (8,000gp)'),
    (44, '+1 weapon with one +2 special ability (18,000gp)'),
    (56, '+2 weapon with one +1 special ability (18,000gp)'),
    (68, '+2 weapon with one +2 special ability (32,000gp)'),
    (80, '+3 weapon with one +1 special ability (32,000gp)'),
    (100, lambda: roll(gmed_special_weapon)),
    ]
lmaj_weapon = [
    (10, '+3 weapon (18,000gp)'),
    (22, '+4 weapon (32,000gp)'),
    (32, '+1 weapon with one +2 special ability (18,000gp)'),
    (44, '+1 weapon with one +3 special ability (32,000gp)'),
    (56, '+2 weapon with one +2 special ability (32,000gp)'),
    (68, '+3 weapon with one +1 special ability (32,000gp)'),
    (80, '+4 weapon with one +1 special ability (50,000gp)'),
    (100, lambda: roll(lmaj_special_weapon)),
    ]
gmaj_weapon = [
    (10, '+4 weapon (32,000gp)'),
    (20, '+5 weapon (50,000gp)'),
    (30, '+4 weapon with one +1 special ability (50,000gp)'),
    (38, '+4 weapon with one +2 special ability (72,000gp)'),
    (46, '+4 weapon with one +3 special ability (98,000gp)'),
    (51, '+4 weapon with one +4 special ability (128,000gp)'),
    (59, '+5 weapon with one +1 special ability (72,000gp)'),
    (67, '+5 weapon with one +2 special ability (98,000gp)'),
    (71, '+5 weapon with one +3 special ability (128,000gp)'),
    (74, '+5 weapon with one +4 special ability (162,000gp)'),
    (77, '+5 weapon with one +4 special ability and one +1 special ability (200,000gp)'),
    (80, '+5 weapon with one +3 special ability and one +2 special ability (200,000gp)'),
    (100, lambda: roll(gmaj_special_weapon)),
    ]
weapon_type = [
    (1, 'Bastard Sword'),
    (5, 'Battleaxe'),
    (6, 'Bolas'),
    (8, 'Club'),
    (10, 'Composite Longbow'),
    (12, 'Composite Shortbow'),
    (16, 'Dagger'),
    (17, 'Dart'),
    (18, 'Dwarven Waraxe'),
    (19, 'Falchion'),
    (20, 'Gauntlet'),
    (21, 'Glaive'),
    (24, 'Greataxe'),
    (25, 'Greatclub'),
    (28, 'Greatsword'),
    (29, 'Halberd'),
    (30, 'Handaxe'),
    (33, 'Heavy Crossbow'),
    (34, 'Heavy Flail'),
    (35, 'Heavy Mace'),
    (37, 'Lance'),
    (40, 'Light Crossbow'),
    (41, 'Light Flail'),
    (42, 'Light Hammer'),
    (44, 'Light Mace'),
    (45, 'Light Pick'),
    (49, 'Longbow'),
    (51, 'Longspear'),
    (58, 'Longsword'),
    (60, 'Morningstar'),
    (61, 'Nunchaku'),
    (63, 'Quarterstaff'),
    (65, 'Rapier'),
    (87, 'Spear'),
    (88, 'Trident'),
    (91, 'Warhammer'),
    (92, 'Whip'),
    (94, 'Other Light Melee Weapon'),
    (96, 'Other One-handed Melee Weapon'),
    (98, 'Other Two-handed Melee Weapon'),
    (100, 'Other Ranged Weapon'),
    ]


def weaponnator(*pair):
    def inner():
        type = roll(weapon_type)
        return recurse(zip((66, 100), pair)).replace('weapon', type)
    return inner

weapon = (
        weaponnator(lmin_weapon, gmin_weapon),
        weaponnator(lmed_weapon, gmed_weapon),
        weaponnator(lmaj_weapon, gmaj_weapon),
        )

p0_common = [
    (14, 'Arcane Mark (25gp)'),
    (28, 'Guidance (25gp)'),
    (44, 'Light (25gp)'),
    (58, 'Purify Food and Drink (25gp)'),
    (72, 'Resistance (25gp)'),
    (86, 'Stabilize (25gp)'),
    (100, 'Virtue (25gp)'),
    ]
p1_common = [
    (4, 'Bless Weapon (50gp)'),
    (14, 'Cure Light Wounds (50gp)'),
    (19, 'Endure Elements (50gp)'),
    (27, 'Enlarge Person (50gp)'),
    (33, 'Jump (50gp)'),
    (41, 'Mage Armor (50gp)'),
    (47, 'Magic Fang (50gp)'),
    (55, 'Magic Weapon (50gp)'),
    (60, 'Pass Without Trace (50gp)'),
    (64, 'Protection from Chaos (50gp)'),
    (68, 'Protection from Evil (50gp)'),
    (72, 'Protection from Good (50gp)'),
    (76, 'Protection from Law (50gp)'),
    (81, 'Reduce Person (50gp)'),
    (87, 'Remove Fear (50gp)'),
    (92, 'Sanctuary (50gp)'),
    (100, 'Shield of Faith (50gp)'),
    ]
p1_uncommon = [
    (4, 'Animate Rope (50gp)'),
    (11, 'Ant Haul (50gp)'),
    (16, 'Cloak of the Shade (50gp)'),
    (20, 'Erase (50gp)'),
    (26, 'Feather Step (50gp)'),
    (30, 'Goodberry (50gp)'),
    (34, 'Grease (50gp)'),
    (41, 'Hide from Animals (50gp)'),
    (49, 'Hide from Undead (50gp)'),
    (53, 'Hold Portal (50gp)'),
    (58, 'Invigorate (50gp)'),
    (64, 'Keen Senses (50gp)'),
    (68, 'Magic Stone (50gp)'),
    (75, 'Remove Sickness (50gp)'),
    (80, 'Sanctify Corpse (50gp)'),
    (84, 'Shillelagh (50gp)'),
    (92, 'Touch of the Sea (50gp)'),
    (100, 'Vanish (50gp)'),
    ]
p2_common = [
    (4, 'Aid (300gp)'),
    (7, 'Align Weapon (300gp)'),
    (11, 'Barkskin (300gp)'),
    (16, 'Bear\'s Endurance (300gp)'),
    (20, 'Blur (300gp)'),
    (25, 'Bull\'s Strength (300gp)'),
    (30, 'Cat\'s Grace (300gp)'),
    (37, 'Cure Moderate Wounds (300gp)'),
    (41, 'Darkvision (300gp)'),
    (44, 'Delay Poison (300gp)'),
    (49, 'Eagle\'s Splendor (300gp)'),
    (54, 'Fox\'s Cunning (300gp)'),
    (61, 'Invisibility (300gp)'),
    (66, 'Levitate (300gp)'),
    (71, 'Owl\'s Wisdom (300gp)'),
    (73, 'Protection from arrows (300gp)'),
    (76, 'Remove Paralysis (300gp)'),
    (80, 'Resist Energy, Acid (300gp)'),
    (84, 'Resist Energy, Cold (300gp)'),
    (88, 'Resist Energy, Electricity (300gp)'),
    (92, 'Resist Energy, Fire (300gp)'),
    (94, 'Resist Energy, Sonic (300gp)'),
    (98, 'Spider Climb (300gp)'),
    (100, 'Undetectable Alignment (300gp)'),
    ]
p2_uncommon = [
    (6, 'Ablative Barrier (300gp)'),
    (14, 'Acute Senses (300gp)'),
    (19, 'Arcane Lock (300gp)'),
    (24, 'Bullet Shield (300gp)'),
    (30, 'Certain Grip (300gp)'),
    (35, 'Continual Flame (350gp)'),
    (40, 'Corruption Resistance (300gp)'),
    (48, 'Disguise Other (300gp)'),
    (56, 'Gentle Repose (300gp)'),
    (61, 'Make Whole (300gp)'),
    (67, 'Obscure Object (300gp)'),
    (72, 'Reduce Animal (300gp)'),
    (76, 'Rope Trick (300gp)'),
    (82, 'Slipstream (300gp)'),
    (90, 'Status (300gp)'),
    (95, 'Warp Wood (300gp)'),
    (100, 'Wood Shape (300gp)'),
    ]
p3_common = [
    (6, 'Cure Serious Wounds (750gp)'),
    (10, 'Dispel Magic (750gp)'),
    (14, 'Displacement (750gp)'),
    (20, 'Fly (750gp)'),
    (25, 'Gaseous Form (750gp)'),
    (29, 'Good Hope (750gp)'),
    (35, 'Haste (750gp)'),
    (40, 'Heroism (750gp)'),
    (44, 'Keen Edge (750gp)'),
    (48, 'Magic Fang, Greater (750gp)'),
    (52, 'Magic Vestment (750gp)'),
    (57, 'Neutralize Poison (750gp)'),
    (60, 'Protection from Energy, Acid (750gp)'),
    (63, 'Protection from Energy, Cold (750gp)'),
    (66, 'Protection from Energy, Electricity (750gp)'),
    (69, 'Protection from Energy, Fire (750gp)'),
    (71, 'Protection from Energy, Sonic (750gp)'),
    (74, 'Rage (750gp)'),
    (77, 'Remove Blindness/Deafness (750gp)'),
    (81, 'Remove Curse (750gp)'),
    (86, 'Remove Disease (750gp)'),
    (91, 'Tongues (750gp)'),
    (96, 'Water Breathing (750gp)'),
    (100, 'Water Walk (750gp)'),
    ]
p3_uncommon = [
    (12, 'Burrow (750gp)'),
    (22, 'Countless Eyes (750gp)'),
    (34, 'Daylight (750gp)'),
    (49, 'Draconic Reservoir (750gp)'),
    (58, 'Flame Arrow (750gp)'),
    (67, 'Shrink Item (750gp)'),
    (77, 'Stone Shape (750gp)'),
    (87, 'Fire Trap (775gp)'),
    (100, 'Nondetection (800gp)'),
    ]
p0 = lambda: 'Potion "%s" (0th)' % roll(p0_common)
p1 = lambda: 'Potion "%s" (1st)' % roll(random.choice((p1_common, p1_common, p1_common, p1_uncommon)))
p2 = lambda: 'Potion "%s" (2nd)' % roll(random.choice((p2_common, p2_common, p2_common, p2_uncommon)))
p3 = lambda: 'Potion "%s" (3rd)' % roll(random.choice((p3_common, p3_common, p3_common, p3_uncommon)))
lmin_potion = [
        (40, p0),
        (100, p1),
        ]
gmin_potion = [
        (10, p0),
        (60, p1),
        (100, p2),
        ]
lmed_potion = [
        (25, p1),
        (85, p2),
        (100, p3),
        ]
gmed_potion = [
        (10, p1),
        (50, p2),
        (100, p3),
        ]
lmaj_potion = [
        (35, p2),
        (100, p3),
        ]
gmaj_potion = [
        (10, p2),
        (100, p3),
        ]
potion = (
    lambda: roll(zip((66, 100), (lmin_potion, gmin_potion))),
    lambda: roll(zip((66, 100), (lmed_potion, gmed_potion))),
    lambda: roll(zip((66, 100), (lmaj_potion, gmaj_potion))),
    )

lmin_ring = [
    (7, 'Dungeon Ring, Prisoner\'s (250gp)'),
    (16, 'Ring of Arcane Signets (1,000gp)'),
    (25, 'Ring of Spell Knowledge I (1,500gp)'),
    (40, 'Ring of Protection +1 (2,000gp)'),
    (47, 'Ring of the Grasping Grave (2,000gp)'),
    (57, 'Ring of Feather Falling (2,200gp)'),
    (66, 'Ring of Climbing (2,500gp)'),
    (75, 'Ring of Jumping (2,500gp)'),
    (84, 'Ring of Sustenance (2,500gp)'),
    (93, 'Ring of Swimming (2,500gp)'),
    (100, 'Ring of Ferocious Action (3,000gp)'),
    ]
gmin_ring = [
    (15, 'Ring of Counterspells (4,000gp)'),
    (25, 'Ring of Maniacal Devices (5,000gp)'),
    (35, 'Ring of Rat Fangs (5,000gp)'),
    (52, 'Ring of Sacred Mistletoe (6,000gp)'),
    (69, 'Ring of Spell Knowledge II (6,000gp)'),
    (86, 'Ring of Swarming Stabs (6,000gp)'),
    (100, 'Ring of Grit Mastery (6,840gp)'),
    ]
lmed_ring = [
    (2, 'Ring of Forcefangs (8,000gp)'),
    (6, 'Ring of Mind Shielding (8,000gp)'),
    (11, 'Ring of Protection +2 (8,000gp)'),
    (13, 'Ring of Strength Sapping (8,000gp)'),
    (17, 'Ring of Force Shield (8,500gp)'),
    (22, 'Ring of the Ram (8,600gp)'),
    (24, 'Scholar\'s Ring (8,700gp)'),
    (27, 'Ring of Climbing, Improved (10,000gp)'),
    (29, 'Ring of Curing (10,000gp)'),
    (31, 'Ring of Foe Focus (10,000gp)'),
    (35, 'Ring of Jumping, Improved (10,000gp)'),
    (37, 'Ring of Ki mastery (10,000gp)'),
    (40, 'Ring of Revelation, Lesser (10,000gp)'),
    (43, 'Ring of Swimming, Improved (10,000gp)'),
    (46, 'Ring of Animal Friendship (10,800gp)'),
    (48, 'Ring of Transposition (10,800gp)'),
    (50, 'Ring of Tactical Precision (11,000gp)'),
    (52, 'Ring of the Sophisticate (11,000gp)'),
    (55, 'Decoy Ring (12,000gp)'),
    (58, 'Ring of Craft Magic (12,000gp)'),
    (61, 'Ring of Ectoplasmic Invigoration (12,000gp)'),
    (64, 'Ring of Energy Resistance, Minor (12,000gp)'),
    (67, 'Ring of the Troglodyte (12,000gp)'),
    (70, 'Steelhand Circle (12,000gp)'),
    (76, 'Ring of Chameleon Power (12,700gp)'),
    (79, 'Ring of Spell Knowledge III (13,500gp)'),
    (82, 'Ring of The Sea Strider (14,000gp)'),
    (85, 'Ring of Retribution (15,000gp)'),
    (89, 'Ring of Water Walking (15,000gp)'),
    (95, 'Dungeon Ring, Jailer\'s (16,000gp)'),
    (100, 'Ring of Revelation, Greater (16,000gp)'),
    ]
gmed_ring = [
    (4, 'Ring of Inner Fortitude, Minor (18,000gp)'),
    (16, 'Ring of Protection +3 (18,000gp)'),
    (26, 'Ring of Spell Storing, Minor (18,000gp)'),
    (30, 'Ring of Energy Shroud (19,500gp)'),
    (35, 'Ring of Arcane Mastery (20,000gp)'),
    (46, 'Ring of Invisibility (20,000gp)'),
    (54, 'Ring of Wizardry I (20,000gp)'),
    (60, 'Ring of Revelation, Superior (24,000gp)'),
    (68, 'Ring of Spell Knowledge IV (24,000gp)'),
    (80, 'Ring of Evasion (25,000gp)'),
    (88, 'Ring of X-ray Vision (25,000gp)'),
    (100, 'Ring of Blinking (27,000gp)'),
    ]
lmaj_ring = [
    (9, 'Ring of Energy Resistance, Major (28,000gp)'),
    (16, 'Ring of The Ecclesiarch (28,500gp)'),
    (33, 'Ring of Protection +4 (32,000gp)'),
    (39, 'Ring of Return (33,600gp)'),
    (55, 'Ring of Freedom of Movement (40,000gp)'),
    (70, 'Ring of Wizardry II (40,000gp)'),
    (75, 'Ring of Inner Fortitude, Major (42,000gp)'),
    (92, 'Ring of Energy Resistance, Greater (44,000gp)'),
    (100, 'Ring of Delayed Doom (45,000gp)'),
    ]
gmaj_ring = [
    (6, 'Ring of Friend Shield (50,000gp)'),
    (18, 'Ring of Protection +5 (50,000gp)'),
    (27, 'Ring of Shooting Stars (50,000gp)'),
    (37, 'Ring of Spell Storing (50,000gp)'),
    (43, 'Ring of Continuation (56,000gp)'),
    (48, 'Ring of Inner Fortitude, Greater (66,000gp)'),
    (57, 'Ring of Wizardry III (70,000gp)'),
    (63, 'Spiritualist Rings (70,000gp)'),
    (71, 'Ring of Telekinesis (75,000gp)'),
    (76, 'Ring of Regeneration (90,000gp)'),
    (82, 'Ring of Spell Turning (100,000gp)'),
    (86, 'Ring of Wizardry IV (100,000gp)'),
    (90, 'Ring of Three Wishes (120,000gp)'),
    (93, 'Ring of Djinni Calling (125,000gp)'),
    (97, 'Ring of Elemental Command (200,000gp)'),
    (100, 'Ring of Spell Storing, Major (200,000gp)'),
    ]
ring = (
    lambda: roll(zip((66, 100), (lmin_ring, gmin_ring))),
    lambda: roll(zip((66, 100), (lmed_ring, gmed_ring))),
    lambda: roll(zip((66, 100), (lmaj_ring, gmaj_ring))),
    )

lmed_rod = [
    (1, 'Metamagic Rod, Merciful, Minor (1,500gp)'),
    (34, 'Metamagic Rod (+1 spell level), Minor (3,000gp)'),
    (49, 'Immovable Rod (5,000gp)'),
    (59, 'Rod of Thunderous Force (5,400gp)'),
    (60, 'Metamagic Rod, Merciful, Normal (5,500gp)'),
    (61, 'Rod of Ice (8,500gp)'),
    (71, 'Metamagic Rod (+2 spell level), Minor (9,000gp)'),
    (81, 'Rod of Metal and Mineral Detection (10,500gp)'),
    (86, 'Metamagic Rod (+1 spell level), Normal (11,000gp)'),
    (100, 'Rod of Cancellation (11,000gp)'),
    ]
gmed_rod = [
    (3, 'Conduit Rod (12,000gp)'),
    (6, 'Grounding Rod (12,000gp)'),
    (10, 'Rod of the Wayang (12,000gp)'),
    (18, 'Rod of Wonder (12,000gp)'),
    (19, 'Metamagic Rod, Merciful, Greater (12,250gp)'),
    (29, 'Rod of the Python (13,000gp)'),
    (33, 'Trap-stealer\'s Rod (13,500gp)'),
    (55, 'Metamagic Rod (+3 spell level), Minor (14,000gp)'),
    (59, 'Rod of Balance (15,000gp)'),
    (63, 'Rod of Escape (15,000gp)'),
    (72, 'Rod of Flame Extinguishing (15,000gp)'),
    (76, 'Rod of Ruin (16,000gp)'),
    (80, 'Sapling Rod (16,650gp)'),
    (86, 'Rod of Beguiling (18,000gp)'),
    (90, 'Rod of Nettles (18,000gp)'),
    (100, 'Rod of the Viper (19,000gp)'),
    ]
lmaj_rod = [
    (4, 'Suzerain scepter (20,000gp)'),
    (6, 'Fiery Nimbus Rod (22,305gp)'),
    (13, 'Rod of Enemy Detection (23,500gp)'),
    (27, 'Metamagic Rod (+1 spell level), Greater (24,500gp)'),
    (36, 'Rod of Splendor (25,000gp)'),
    (44, 'Rod of Withering (25,000gp)'),
    (50, 'Earthbind Rod (26,500gp)'),
    (56, 'Rod of the Aboleth (29,000gp)'),
    (63, 'Liberator\'s Rod (30,000gp)'),
    (70, 'Metamagic Rod (+2 spell level), Normal (32,500gp)'),
    (79, 'Rod of Thunder and Lightning (33,000gp)'),
    (83, 'Metamagic Rod, Quicken, Minor (35,000gp)'),
    (94, 'Rod of Negation (37,000gp)'),
    (100, 'Rod of Steadfast Resolve (38,305gp)'),
    ]
gmaj_rod = [
    (8, 'Rod of Absorption (50,000gp)'),
    (11, 'Rod of Flailing (50,000gp)'),
    (26, 'Metamagic Rod (+3 spell level), normal (54,000gp)'),
    (28, 'Rod of Rulership (60,000gp)'),
    (30, 'Rod of Security (61,000gp)'),
    (32, 'Rod of Shadows (64,305gp)'),
    (34, 'Rod of Mind Mastery (67,000gp)'),
    (37, 'Rod of Lordly Might (70,000gp)'),
    (57, 'Metamagic Rod (+2 spell level), Greater (73,000gp)'),
    (58, 'Scepter of Heaven (74,000gp)'),
    (68, 'Metamagic Rod, Quicken, Normal (75,500gp)'),
    (70, 'Rod of Dwarven Might (80,000gp)'),
    (75, 'Rod of Alertness (85,000gp)'),
    (95, 'Metamagic Rod (+3 spell level), Greater (121,500gp)'),
    (100, 'Metamagic Rod, Quicken, Greater (170,000gp)'),
    ]
rod = (
    (None),
    lambda: roll(zip((66, 100), (lmed_rod, gmed_rod))),
    lambda: roll(zip((66, 100), (lmaj_rod, gmaj_rod))),
    )

sa0_common = [
    (9, 'Acid splash (15gp)'),
    (17, 'Daze (15gp)'),
    (27, 'Detect magic (15gp)'),
    (35, 'Flare (15gp)'),
    (45, 'Light (15gp)'),
    (55, 'Mage hand (15gp)'),
    (63, 'Mending (15gp)'),
    (72, 'Prestidigitation (15gp)'),
    (81, 'Ray of frost (15gp)'),
    (91, 'Read magic (15gp)'),
    (100, 'Touch of fatigue (15gp)'),
    ]
sa0_uncommon = [
    (7, 'Arcane mark (15gp)'),
    (17, 'Bleed (15gp)'),
    (25, 'Dancing lights (15gp)'),
    (35, 'Detect poison (15gp)'),
    (42, 'Disrupt undead (15gp)'),
    (51, 'Ghost sound (15gp)'),
    (61, 'Message (15gp)'),
    (68, 'Open/close (15gp)'),
    (75, 'Resistance (15gp)'),
    (83, 'Sift (15gp)'),
    (92, 'Spark (15gp)'),
    (100, 'Unwitting ally (15gp)'),
    ]
sa1_common = [
    (5, 'Burning hands (25gp)'),
    (9, 'Cause fear (25gp)'),
    (14, 'Charm person (25gp)'),
    (17, 'Chill touch (25gp)'),
    (21, 'Disguise self (25gp)'),
    (24, 'Endure elements (25gp)'),
    (28, 'Enlarge person (25gp)'),
    (32, 'Expeditious retreat (25gp)'),
    (36, 'Grease (25gp)'),
    (39, 'Hypnotism (25gp)'),
    (42, 'Identify (25gp)'),
    (48, 'Mage armor (25gp)'),
    (54, 'Magic missile (25gp)'),
    (58, 'Magic weapon (25gp)'),
    (62, 'Obscuring mist (25gp)'),
    (64, 'Protection from chaos (25gp)'),
    (67, 'Protection from evil (25gp)'),
    (69, 'Protection from good (25gp)'),
    (71, 'Protection from law (25gp)'),
    (75, 'Ray of enfeeblement (25gp)'),
    (80, 'Shield (25gp)'),
    (84, 'Shocking grasp (25gp)'),
    (88, 'Silent image (25gp)'),
    (93, 'Sleep (25gp)'),
    (96, 'Summon monster I (25gp)'),
    (100, 'True strike (25gp)'),
    ]
sa1_uncommon = [
    (2, 'Air bubble (25gp)'),
    (6, 'Alarm (25gp)'),
    (8, 'Animate rope (25gp)'),
    (12, 'Ant haul (25gp)'),
    (15, 'Blend (25gp)'),
    (18, 'Break (25gp)'),
    (23, 'Color spray (25gp)'),
    (26, 'Comprehend languages (25gp)'),
    (30, 'Corrosive touch (25gp)'),
    (33, 'Detect secret doors (25gp)'),
    (36, 'Detect undead (25gp)'),
    (38, 'Erase (25gp)'),
    (40, 'Flare burst (25gp)'),
    (43, 'Floating disk (25gp)'),
    (46, 'Hold portal (25gp)'),
    (48, 'Hydraulic push (25gp)'),
    (51, 'Icicle dagger (25gp)'),
    (54, 'Illusion of calm (25gp)'),
    (58, 'Jump (25gp)'),
    (60, 'Magic aura (25gp)'),
    (63, 'Mirror strike (25gp)'),
    (66, 'Mount (25gp)'),
    (69, 'Ray of sickening (25gp)'),
    (71, 'Reduce person (25gp)'),
    (74, 'Shadow weapon (25gp)'),
    (77, 'Shock shield (25gp)'),
    (80, 'Stone fist (25gp)'),
    (84, 'Touch of the sea (25gp)'),
    (88, 'Unseen servant (25gp)'),
    (91, 'Urban grace (25gp)'),
    (96, 'Vanish (25gp)'),
    (98, 'Ventriloquism (25gp)'),
    (100, 'Voice alteration (25gp)'),
    ]
sa2_common = [
    (4, 'Acid arrow (150gp)'),
    (7, 'Alter self (150gp)'),
    (12, 'Bear\'s endurance (150gp)'),
    (15, 'Blur (150gp)'),
    (20, 'Bull\'s strength (150gp)'),
    (24, 'Cat\'s grace (150gp)'),
    (27, 'Darkness (150gp)'),
    (30, 'Darkvision (150gp)'),
    (34, 'Eagle\'s splendor (150gp)'),
    (37, 'False life (150gp)'),
    (40, 'Flaming sphere (150gp)'),
    (44, 'Fox\'s cunning (150gp)'),
    (47, 'Glitterdust (150gp)'),
    (52, 'Invisibility (150gp)'),
    (54, 'Knock (150gp)'),
    (58, 'Levitate (150gp)'),
    (61, 'Minor image (150gp)'),
    (65, 'Mirror image (150gp)'),
    (69, 'Owl\'s wisdom (150gp)'),
    (73, 'Resist energy (150gp)'),
    (75, 'Rope trick (150gp)'),
    (80, 'Scorching ray (150gp)'),
    (83, 'See invisibility (150gp)'),
    (85, 'Shatter (150gp)'),
    (88, 'Spider climb (150gp)'),
    (91, 'Summon monster II (150gp)'),
    (93, 'Summon swarm (150gp)'),
    (98, 'Web (150gp)'),
    (100, 'Whispering wind (150gp)'),
    ]
sa2_uncommon = [
    (3, 'Bestow weapon proficiency (150gp)'),
    (6, 'Blindness/deafness (150gp)'),
    (9, 'Burning gaze (150gp)'),
    (12, 'Certain grip (150gp)'),
    (14, 'Command undead (150gp)'),
    (16, 'Create pit (150gp)'),
    (20, 'Daze monster (150gp)'),
    (23, 'Detect thoughts (150gp)'),
    (27, 'Disguise other (150gp)'),
    (31, 'Elemental touch (150gp)'),
    (34, 'Fire breath (150gp)'),
    (38, 'Fog cloud (150gp)'),
    (40, 'Ghoul touch (150gp)'),
    (41, 'Glide (150gp)'),
    (44, 'Gust of wind (150gp)'),
    (47, 'Haunting mists (150gp)'),
    (51, 'Hideous laughter (150gp)'),
    (54, 'Hypnotic pattern (150gp)'),
    (57, 'Locate object (150gp)'),
    (60, 'Make whole (150gp)'),
    (62, 'Misdirection (150gp)'),
    (63, 'Obscure object (150gp)'),
    (65, 'Pernicious poison (150gp)'),
    (67, 'Protection from arrows (150gp)'),
    (70, 'Pyrotechnics (150gp)'),
    (73, 'Returning weapon (150gp)'),
    (77, 'Scare (150gp)'),
    (80, 'Shadow anchor (150gp)'),
    (83, 'Share memory (150gp)'),
    (85, 'Slipstream (150gp)'),
    (88, 'Spectral hand (150gp)'),
    (90, 'Spontaneous immolation (150gp)'),
    (93, 'Touch of idiocy (150gp)'),
    (94, 'Unshakable chill (150gp)'),
    (96, 'Magic mouth (160gp)'),
    (97, 'Arcane lock (175gp)'),
    (99, 'Continual flame (200gp)'),
    (100, 'Phantom trap (200gp)'),
    ]
sa3_common = [
    (3, 'Beast shape I (375gp)'),
    (7, 'Blink (375gp)'),
    (12, 'Dispel magic (375gp)'),
    (16, 'Displacement (375gp)'),
    (21, 'Fireball (375gp)'),
    (24, 'Flame arrow (375gp)'),
    (29, 'Fly (375gp)'),
    (32, 'Gaseous form (375gp)'),
    (37, 'Haste (375gp)'),
    (40, 'Heroism (375gp)'),
    (43, 'Hold person (375gp)'),
    (46, 'Invisibility sphere (375gp)'),
    (51, 'Lightning bolt (375gp)'),
    (54, 'Magic circle against chaos (375gp)'),
    (57, 'Magic circle against evil (375gp)'),
    (60, 'Magic circle against good (375gp)'),
    (63, 'Magic circle against law (375gp)'),
    (66, 'Major image (375gp)'),
    (70, 'Phantom steed (375gp)'),
    (74, 'Protection from energy (375gp)'),
    (78, 'Slow (375gp)'),
    (81, 'Stinking cloud (375gp)'),
    (84, 'Suggestion (375gp)'),
    (87, 'Summon monster III (375gp)'),
    (90, 'Tiny hut (375gp)'),
    (94, 'Tongues (375gp)'),
    (97, 'Vampiric touch (375gp)'),
    (100, 'Water breathing (375gp)'),
    ]
sa3_uncommon = [
    (3, 'Animate dead, lesser (375gp)'),
    (6, 'Aqueous orb (375gp)'),
    (8, 'Arcane sight (375gp)'),
    (12, 'Beast shape (375gp)'),
    (15, 'Clairaudience/clairvoyance (375gp)'),
    (17, 'Cloak of winds (375gp)'),
    (20, 'Daylight (375gp)'),
    (24, 'Deep slumber (375gp)'),
    (27, 'Distracting cacophony (375gp)'),
    (30, 'Draconic reservoir (375gp)'),
    (35, 'Elemental aura (375gp)'),
    (38, 'Explosive runes (375gp)'),
    (43, 'Force punch (375gp)'),
    (45, 'Gentle repose (375gp)'),
    (47, 'Halt undead (375gp)'),
    (49, 'Healing thief (375gp)'),
    (51, 'Hydraulic torrent (375gp)'),
    (56, 'Keen edge (375gp)'),
    (61, 'Magic weapon, greater (375gp)'),
    (65, 'Monstrous physique I (375gp)'),
    (68, 'Rage (375gp)'),
    (70, 'Ray of exhaustion (375gp)'),
    (73, 'Resinous skin (375gp)'),
    (75, 'Resist energy, communal (375gp)'),
    (78, 'Secret page (375gp)'),
    (80, 'Shrink item (375gp)'),
    (83, 'Sleet storm (375gp)'),
    (86, 'Spiked pit (375gp)'),
    (90, 'Undead anatomy I (375gp)'),
    (92, 'Versatile weapon (375gp)'),
    (95, 'Wind wall (375gp)'),
    (96, 'Illusory script (425gp)'),
    (99, 'Nondetection (425gp)'),
    (100, 'Sepia snake sigil (875gp)'),
    ]
sa4_common = [
    (3, 'Beast shape II (700gp)'),
    (5, 'Bestow curse (700gp)'),
    (9, 'Black tentacles (700gp)'),
    (14, 'Charm monster (700gp)'),
    (18, 'Confusion (700gp)'),
    (21, 'Crushing despair (700gp)'),
    (26, 'Dimension door (700gp)'),
    (29, 'Dimensional anchor (700gp)'),
    (32, 'Elemental body I (700gp)'),
    (36, 'Enervation (700gp)'),
    (38, 'Enlarge person, mass (700gp)'),
    (43, 'Fear (700gp)'),
    (47, 'Fire shield (700gp)'),
    (50, 'Globe of invulnerability, lesser (700gp)'),
    (54, 'Ice storm (700gp)'),
    (59, 'Invisibility, greater (700gp)'),
    (64, 'Phantasmal killer (700gp)'),
    (67, 'Resilient sphere (700gp)'),
    (71, 'Scrying (700gp)'),
    (74, 'Shadow conjuration (700gp)'),
    (76, 'Shout (700gp)'),
    (78, 'Solid fog (700gp)'),
    (80, 'Stone shape (700gp)'),
    (83, 'Summon monster IV (700gp)'),
    (88, 'Wall of fire (700gp)'),
    (92, 'Wall of ice (700gp)'),
    (97, 'Stoneskin (950gp)'),
    (100, 'Animate dead (1,050gp)'),
    ]
sa4_uncommon = [
    (2, 'Acid pit (700gp)'),
    (6, 'Arcane eye (700gp)'),
    (10, 'Ball lightning (700gp)'),
    (13, 'Contagion (700gp)'),
    (17, 'Darkvision, greater (700gp)'),
    (19, 'Detect scrying (700gp)'),
    (23, 'Dragon\'s breath (700gp)'),
    (28, 'False life, greater (700gp)'),
    (32, 'Firefall (700gp)'),
    (35, 'Geas, lesser (700gp)'),
    (39, 'Ghost wolf (700gp)'),
    (41, 'Hallucinatory terrain (700gp)'),
    (43, 'Illusory wall (700gp)'),
    (46, 'Locate creature (700gp)'),
    (50, 'Minor creation (700gp)'),
    (54, 'Monstrous physique II (700gp)'),
    (57, 'Obsidian flow (700gp)'),
    (59, 'Phantom chariot (700gp)'),
    (62, 'Rainbow pattern (700gp)'),
    (64, 'Reduce person, mass (700gp)'),
    (68, 'Remove curse (700gp)'),
    (71, 'Secure shelter (700gp)'),
    (74, 'Shadow projection (700gp)'),
    (79, 'Shocking image (700gp)'),
    (83, 'Telekinetic charge (700gp)'),
    (85, 'True form (700gp)'),
    (89, 'Vermin shape I (700gp)'),
    (94, 'Volcanic storm (700gp)'),
    (97, 'Wandering star motes (700gp)'),
    (99, 'Fire trap (725gp)'),
    (100, 'Mnemonic enhancer (750gp)'),
    ]
sa5_common = [
    (3, 'Baleful polymorph (1,125gp)'),
    (7, 'Beast shape III (1,125gp)'),
    (10, 'Break enchantment (1,125gp)'),
    (15, 'Cloudkill (1,125gp)'),
    (21, 'Cone of cold (1,125gp)'),
    (23, 'Contact other plane (1,125gp)'),
    (26, 'Dismissal (1,125gp)'),
    (31, 'Dominate person (1,125gp)'),
    (35, 'Feeblemind (1,125gp)'),
    (40, 'Hold monster (1,125gp)'),
    (43, 'Magic jar (1,125gp)'),
    (46, 'Mind fog (1,125gp)'),
    (51, 'Overland flight (1,125gp)'),
    (54, 'Passwall (1,125gp)'),
    (56, 'Permanency (1,125gp)'),
    (58, 'Planar binding, lesser (1,125gp)'),
    (62, 'Polymorph (1,125gp)'),
    (65, 'Sending (1,125gp)'),
    (69, 'Shadow evocation (1,125gp)'),
    (73, 'Summon monster V (1,125gp)'),
    (76, 'Telekinesis (1,125gp)'),
    (82, 'Teleport (1,125gp)'),
    (88, 'Wall of force (1,125gp)'),
    (92, 'Wall of stone (1,125gp)'),
    (95, 'Waves of fatigue (1,125gp)'),
    (97, 'Symbol of pain (2,125gp)'),
    (100, 'Symbol of sleep (2,125gp)'),
    ]
sa5_uncommon = [
    (2, 'Absorb toxicity (1,125gp)'),
    (4, 'Animal growth (1,125gp)'),
    (6, 'Blight (1,125gp)'),
    (9, 'Dream (1,125gp)'),
    (13, 'Elemental body II (1,125gp)'),
    (15, 'Fabricate (1,125gp)'),
    (19, 'Fire snake (1,125gp)'),
    (22, 'Hostile juxtaposition (1,125gp)'),
    (25, 'Hungry pit (1,125gp)'),
    (29, 'Icy prison (1,125gp)'),
    (33, 'Interposing hand (1,125gp)'),
    (36, 'Life bubble (1,125gp)'),
    (38, 'Mage\'s faithful hound (1,125gp)'),
    (40, 'Mage\'s private sanctum (1,125gp)'),
    (43, 'Major creation (1,125gp)'),
    (46, 'Mirage arcana (1,125gp)'),
    (50, 'Monstrous physique III (1,125gp)'),
    (54, 'Nightmare (1,125gp)'),
    (56, 'Persistent image (1,125gp)'),
    (60, 'Planar adaptation (1,125gp)'),
    (64, 'Plant shape I (1,125gp)'),
    (68, 'Prying eyes (1,125gp)'),
    (70, 'Secret chest (1,125gp)'),
    (73, 'Seeming (1,125gp)'),
    (76, 'Sonic thrust (1,125gp)'),
    (79, 'Suffocation (1,125gp)'),
    (82, 'Telepathic bond (1,125gp)'),
    (84, 'Transmute mud to rock (1,125gp)'),
    (86, 'Transmute rock to mud (1,125gp)'),
    (90, 'Undead anatomy II (1,125gp)'),
    (94, 'Vermin form II (1,125gp)'),
    (98, 'Wind blades (1,125gp)'),
    (100, 'False vision (1,375gp)'),
    ]
sa6_common = [
    (3, 'Acid fog (1,650gp)'),
    (7, 'Antimagic field (1,650gp)'),
    (10, 'Bear\'s endurance, mass (1,650gp)'),
    (13, 'Beast shape IV (1,650gp)'),
    (16, 'Bull\'s strength, mass (1,650gp)'),
    (19, 'Cat\'s grace, mass (1,650gp)'),
    (25, 'Chain lightning (1,650gp)'),
    (31, 'Disintegrate (1,650gp)'),
    (37, 'Dispel magic, greater (1,650gp)'),
    (40, 'Eagle\'s splendor, mass (1,650gp)'),
    (42, 'Eyebite (1,650gp)'),
    (47, 'Flesh to stone (1,650gp)'),
    (50, 'Form of the dragon I (1,650gp)'),
    (53, 'Fox\'s cunning, mass (1,650gp)'),
    (56, 'Globe of invulnerability (1,650gp)'),
    (59, 'Heroism, greater (1,650gp)'),
    (62, 'Mislead (1,650gp)'),
    (65, 'Owl\'s wisdom, mass (1,650gp)'),
    (67, 'Planar binding (1,650gp)'),
    (70, 'Shadow walk (1,650gp)'),
    (72, 'Stone to flesh (1,650gp)'),
    (76, 'Suggestion, mass (1,650gp)'),
    (79, 'Summon monster VI (1,650gp)'),
    (82, 'Transformation (1,650gp)'),
    (84, 'Veil (1,650gp)'),
    (87, 'Wall of iron (1,700gp)'),
    (89, 'Create undead (1,750gp)'),
    (92, 'Legend lore (1,900gp)'),
    (96, 'True seeing (1,900gp)'),
    (98, 'Circle of death (2,150gp)'),
    (100, 'Symbol of fear (2,650gp)'),
    ]
sa6_uncommon = [
    (4, 'Analyze dweomer (1,650gp)'),
    (8, 'Battlemind link (1,650gp)'),
    (12, 'Cloak of dreams (1,650gp)'),
    (15, 'Contagion, greater (1,650gp)'),
    (20, 'Contagious flame (1,650gp)'),
    (26, 'Contingency (1,650gp)'),
    (30, 'Control water (1,650gp)'),
    (35, 'Elemental body III (1,650gp)'),
    (39, 'Fluid form (1,650gp)'),
    (45, 'Forceful hand (1,650gp)'),
    (48, 'Freezing sphere (1,650gp)'),
    (53, 'Geas/quest (1,650gp)'),
    (57, 'Getaway (1,650gp)'),
    (59, 'Guards and wards (1,650gp)'),
    (61, 'Mage\'s lucubration (1,650gp)'),
    (66, 'Monstrous physique IV (1,650gp)'),
    (68, 'Move earth (1,650gp)'),
    (71, 'Permanent image (1,650gp)'),
    (76, 'Plant shape II (1,650gp)'),
    (80, 'Repulsion (1,650gp)'),
    (84, 'Sirocco (1,650gp)'),
    (87, 'Tar pool (1,650gp)'),
    (92, 'Undead anatomy III (1,650gp)'),
    (95, 'Programmed image (1,675gp)'),
    (98, 'Undeath to death (2,150gp)'),
    (100, 'Symbol of persuasion (6,650gp)'),
    ]
sa7_common = [
    (4, 'Arcane sight, greater (2,275gp)'),
    (7, 'Banishment (2,275gp)'),
    (13, 'Delayed blast fireball (2,275gp)'),
    (17, 'Ethereal jaunt (2,275gp)'),
    (22, 'Finger of death (2,275gp)'),
    (27, 'Form of the dragon II (2,275gp)'),
    (30, 'Hold person, mass (2,275gp)'),
    (35, 'Invisibility, mass (2,275gp)'),
    (39, 'Mage\'s sword (2,275gp)'),
    (42, 'Phase door (2,275gp)'),
    (48, 'Plane shift (2,275gp)'),
    (53, 'Polymorph, greater (2,275gp)'),
    (57, 'Power word blind (2,275gp)'),
    (62, 'Prismatic spray (2,275gp)'),
    (66, 'Reverse gravity (2,275gp)'),
    (70, 'Scrying, greater (2,275gp)'),
    (73, 'Shadow conjuration, greater (2,275gp)'),
    (78, 'Spell turning (2,275gp)'),
    (81, 'Summon monster VII (2,275gp)'),
    (87, 'Teleport, greater (2,275gp)'),
    (90, 'Waves of exhaustion (2,275gp)'),
    (93, 'Project image (2,280gp)'),
    (97, 'Forcecage (2,775gp)'),
    (100, 'Limited wish (3,775gp)'),
    ]
sa7_uncommon = [
    (3, 'Control undead (2,275gp)'),
    (7, 'Control weather (2,275gp)'),
    (10, 'Create demiplane, lesser (2,275gp)'),
    (14, 'Deflection (2,275gp)'),
    (19, 'Elemental body IV (2,275gp)'),
    (23, 'Firebrand (2,275gp)'),
    (29, 'Fly, mass (2,275gp)'),
    (34, 'Giant form I (2,275gp)'),
    (40, 'Grasping hand (2,275gp)'),
    (44, 'Hostile juxtaposition, greater (2,275gp)'),
    (49, 'Ice body (2,275gp)'),
    (53, 'Insanity (2,275gp)'),
    (56, 'Mage\'s magnificent mansion (2,275gp)'),
    (61, 'Phantasmal revenge (2,275gp)'),
    (65, 'Plague storm (2,275gp)'),
    (70, 'Plant shape III (2,275gp)'),
    (74, 'Resonating word (2,275gp)'),
    (78, 'Sequester (2,275gp)'),
    (81, 'Statue (2,275gp)'),
    (84, 'Teleport object (2,275gp)'),
    (88, 'Walk through space (2,275gp)'),
    (91, 'Vision (2,525gp)'),
    (93, 'Instant summons (3,275gp)'),
    (96, 'Symbol of stunning (7,275gp)'),
    (98, 'Symbol of weakness (7,275gp)'),
    (100, 'Simulacrum (8,775gp)'),
    ]
sa8_common = [
    (5, 'Charm monster, mass (3,000gp)'),
    (9, 'Demand (3,000gp)'),
    (13, 'Dimensional lock (3,000gp)'),
    (18, 'Form of the dragon III (3,000gp)'),
    (23, 'Horrid wilting (3,000gp)'),
    (28, 'Incendiary cloud (3,000gp)'),
    (33, 'Irresistible dance (3,000gp)'),
    (40, 'Maze (3,000gp)'),
    (45, 'Mind blank (3,000gp)'),
    (49, 'Planar binding, greater (3,000gp)'),
    (55, 'Polar ray (3,000gp)'),
    (59, 'Polymorph any object (3,000gp)'),
    (66, 'Power word stun (3,000gp)'),
    (72, 'Prismatic wall (3,000gp)'),
    (76, 'Scintillating pattern (3,000gp)'),
    (80, 'Summon monster VIII (3,000gp)'),
    (85, 'Telekinetic sphere (3,000gp)'),
    (90, 'Protection from spells (3,500gp)'),
    (94, 'Symbol of death (8,000gp)'),
    (97, 'Temporal stasis (8,000gp)'),
    (100, 'Trap the soul (23,000gp)'),
    ]
sa8_uncommon = [
    (4, 'Antipathy (3,000gp)'),
    (10, 'Clenched fist (3,000gp)'),
    (12, 'Clone (3,000gp)'),
    (15, 'Create demiplane (3,000gp)'),
    (19, 'Discern location (3,000gp)'),
    (24, 'Euphoric tranquility (3,000gp)'),
    (29, 'Frightful aspect (3,000gp)'),
    (34, 'Giant form II (3,000gp)'),
    (38, 'Iron body (3,000gp)'),
    (43, 'Moment of prescience (3,000gp)'),
    (47, 'Orb of the void (3,000gp)'),
    (52, 'Pyrying eyes, greater (3,000gp)'),
    (56, 'Screen (3,000gp)'),
    (62, 'Shadow evocation, greater (3,000gp)'),
    (66, 'Shout, greater (3,000gp)'),
    (72, 'Stormbolts (3,000gp)'),
    (76, 'Sunburst (3,000gp)'),
    (81, 'Undead anatomy IV (3,000gp)'),
    (87, 'Wall of lava (3,000gp)'),
    (91, 'Create greater undead (3,150gp)'),
    (95, 'Sympathy (4,500gp)'),
    (98, 'Symbol of insanity (8,000gp)'),
    (100, 'Binding (chaining) (13,000gp)'),
    ]
sa9_common = [
    (6, 'Dominate monster (3,825gp)'),
    (11, 'Energy drain (3,825gp)'),
    (16, 'Freedom (3,825gp)'),
    (23, 'Gate (3,825gp)'),
    (28, 'Hold monster, mass (3,825gp)'),
    (33, 'Imprisonment (3,825gp)'),
    (39, 'Mage\'s disjunction (3,825gp)'),
    (47, 'Meteor swarm (3,825gp)'),
    (55, 'Power word kill (3,825gp)'),
    (61, 'Prismatic sphere (3,825gp)'),
    (66, 'Shapechange (3,825gp)'),
    (71, 'Summon monster IX (3,825gp)'),
    (79, 'Time stop (3,825gp)'),
    (85, 'Weird (3,825gp)'),
    (90, 'Astral projection (4,825gp)'),
    (96, 'Teleportation circle (4,825gp)'),
    (100, 'Wish (28,825gp)'),
    ]
sa9_uncommon = [
    (6, 'Create demiplane, greater (3,825gp)'),
    (15, 'Crushing hand (3,825gp)'),
    (23, 'Etherealness (3,825gp)'),
    (31, 'Fiery body (3,825gp)'),
    (38, 'Foresight (3,825gp)'),
    (44, 'Heroic invocation (3,825gp)'),
    (50, 'Icy prison, mass (3,825gp)'),
    (57, 'Ride the lightning (3,825gp)'),
    (65, 'Shades (3,825gp)'),
    (72, 'Soul bind (3,825gp)'),
    (79, 'Tsunami (3,825gp)'),
    (88, 'Wail of the banshee (3,825gp)'),
    (95, 'Winds of vengeance (3,825gp)'),
    (100, 'Refuge (4,325gp)'),
    ]
sd0_common = [
    (11, 'Bleed (15gp)'),
    (21, 'Create water (15gp)'),
    (34, 'Detect magic (15gp)'),
    (44, 'Know direction (15gp)'),
    (55, 'Light (15gp)'),
    (65, 'Mending (15gp)'),
    (75, 'Purify food and drink (15gp)'),
    (88, 'Read magic (15gp)'),
    (100, 'Stabilize (15gp)'),
    ]
sd0_uncommon = [
    (15, 'Detect poison (15gp)'),
    (33, 'Flare (15gp)'),
    (50, 'Guidance (15gp)'),
    (68, 'Resistance (15gp)'),
    (85, 'Spark (15gp)'),
    (100, 'Virtue (15gp)'),
    ]
sd1_common = [
    (4, 'Bane (25gp)'),
    (10, 'Bless (25gp)'),
    (15, 'Cause fear (25gp)'),
    (19, 'Command (25gp)'),
    (22, 'Comprehend languages (25gp)'),
    (28, 'Cure light wounds (25gp)'),
    (30, 'Detect chaos (25gp)'),
    (32, 'Detect evil (25gp)'),
    (34, 'Detect good (25gp)'),
    (36, 'Detect law (25gp)'),
    (39, 'Detect undead (25gp)'),
    (45, 'Divine favor (25gp)'),
    (48, 'Doom (25gp)'),
    (52, 'Entangle (25gp)'),
    (57, 'Inflict light wounds (25gp)'),
    (61, 'Magic fang (25gp)'),
    (65, 'Obscuring mist (25gp)'),
    (68, 'Produce flame (25gp)'),
    (71, 'Protection from chaos (25gp)'),
    (74, 'Protection from evil (25gp)'),
    (77, 'Protection from good (25gp)'),
    (80, 'Protection from law (25gp)'),
    (84, 'Remove fear (25gp)'),
    (88, 'Sanctuary (25gp)'),
    (94, 'Shield of faith (25gp)'),
    (97, 'Summon monster I (25gp)'),
    (100, 'Summon nature\'s ally I (25gp)'),
    ]
sd1_uncommon = [
    (4, 'Ant haul (25gp)'),
    (7, 'Aspect of the falcon (25gp)'),
    (9, 'Calm animals (25gp)'),
    (12, 'Charm animal (25gp)'),
    (15, 'Compel hostility (25gp)'),
    (17, 'Deathwatch (25gp)'),
    (19, 'Detect animals or plants (25gp)'),
    (20, 'Detect snares and pits (25gp)'),
    (23, 'Diagnose disease (25gp)'),
    (27, 'Endure elements (25gp)'),
    (30, 'Entropic shield (25gp)'),
    (33, 'Faerie fire (25gp)'),
    (36, 'Feather step (25gp)'),
    (39, 'Forbid action (25gp)'),
    (42, 'Frostbite (25gp)'),
    (46, 'Goodberry (25gp)'),
    (47, 'Hide from animals (25gp)'),
    (49, 'Hide from undead (25gp)'),
    (52, 'Hydraulic push (25gp)'),
    (55, 'Jump (25gp)'),
    (59, 'Keen senses (25gp)'),
    (62, 'Liberating command (25gp)'),
    (65, 'Longstrider (25gp)'),
    (68, 'Magic stone (25gp)'),
    (72, 'Pass without trace (25gp)'),
    (74, 'Remove sickness (25gp)'),
    (75, 'Sanctify corpse (25gp)'),
    (78, 'Shillelagh (25gp)'),
    (81, 'Speak with animals (25gp)'),
    (85, 'Stone fist (25gp)'),
    (88, 'Stone shield (25gp)'),
    (91, 'Sun metal (25gp)'),
    (95, 'Touch of the sea (25gp)'),
    (98, 'Bless water (50gp)'),
    (100, 'Curse water (50gp)'),
    ]
sd2_common = [
    (4, 'Aid (150gp)'),
    (6, 'Align weapon (150gp)'),
    (8, 'Animal messenger (150gp)'),
    (13, 'Barkskin (150gp)'),
    (16, 'Bear\'s endurance (150gp)'),
    (19, 'Bull\'s strength (150gp)'),
    (22, 'Cat\'s grace (150gp)'),
    (24, 'Chill metal (150gp)'),
    (30, 'Cure moderate wounds (150gp)'),
    (33, 'Darkness (150gp)'),
    (36, 'Delay poison (150gp)'),
    (39, 'Eagle\'s splendor (150gp)'),
    (41, 'Find traps (150gp)'),
    (44, 'Flame blade (150gp)'),
    (46, 'Fog cloud (150gp)'),
    (50, 'Heat metal (150gp)'),
    (52, 'Hold animal (150gp)'),
    (56, 'Hold person (150gp)'),
    (60, 'Inflict moderate wounds (150gp)'),
    (63, 'Owl\'s wisdom (150gp)'),
    (65, 'Remove paralysis (150gp)'),
    (68, 'Resist energy (150gp)'),
    (73, 'Restoration, lesser (150gp)'),
    (77, 'Shield other (150gp)'),
    (81, 'Silence (150gp)'),
    (85, 'Sound burst (150gp)'),
    (89, 'Spiritual weapon (150gp)'),
    (91, 'Summon monster II (150gp)'),
    (93, 'Summon nature\'s ally II (150gp)'),
    (95, 'Summon swarm (150gp)'),
    (97, 'Zone of truth (150gp)'),
    (100, 'Augury (175gp)'),
    ]
sd2_uncommon = [
    (4, 'Animal aspect (150gp)'),
    (6, 'Animal trance (150gp)'),
    (10, 'Animate dead, lesser (150gp)'),
    (13, 'Arrow of law (150gp)'),
    (17, 'Aspect of the bear (150gp)'),
    (20, 'Blessing of courage and life (150gp)'),
    (24, 'Calm emotions (150gp)'),
    (27, 'Death knell (150gp)'),
    (30, 'Dread bolt (150gp)'),
    (34, 'Effortless armor (150gp)'),
    (37, 'Enthrall (150gp)'),
    (41, 'Flaming sphere (150gp)'),
    (43, 'Gentle repose (150gp)'),
    (46, 'Grace (150gp)'),
    (48, 'Groundswell (150gp)'),
    (51, 'Gust of wind (150gp)'),
    (53, 'Instant armor (150gp)'),
    (55, 'Instrument of agony (150gp)'),
    (58, 'Make whole (150gp)'),
    (60, 'Reduce animal (150gp)'),
    (62, 'Scent trail (150gp)'),
    (65, 'Shard of chaos (150gp)'),
    (68, 'Share language (150gp)'),
    (70, 'Shatter (150gp)'),
    (73, 'Soften earth and stone (150gp)'),
    (76, 'Spear of purity (150gp)'),
    (79, 'Spider climb (150gp)'),
    (82, 'Status (150gp)'),
    (84, 'Tree shape (150gp)'),
    (85, 'Undetectable alignment (150gp)'),
    (88, 'Warp wood (150gp)'),
    (91, 'Weapon of awe (150gp)'),
    (93, 'Wood shape (150gp)'),
    (95, 'Consecrate (175gp)'),
    (97, 'Desecrate (175gp)'),
    (99, 'Fire trap (175gp)'),
    (100, 'Masterwork transformation (450gp)'),
    ]
sd3_common = [
    (3, 'Bestow curse (375gp)'),
    (8, 'Call lightning (375gp)'),
    (15, 'Cure serious wounds (375gp)'),
    (19, 'Daylight (375gp)'),
    (23, 'Deeper darkness (375gp)'),
    (28, 'Dispel magic (375gp)'),
    (33, 'Inflict serious wounds (375gp)'),
    (37, 'Invisibility purge (375gp)'),
    (40, 'Locate object (375gp)'),
    (42, 'Magic circle against chaos (375gp)'),
    (44, 'Magic circle against evil (375gp)'),
    (46, 'Magic circle against good (375gp)'),
    (48, 'Magic circle against law (375gp)'),
    (52, 'Magic fang, greater (375gp)'),
    (57, 'Magic vestment (375gp)'),
    (59, 'Poison (375gp)'),
    (65, 'Prayer (375gp)'),
    (68, 'Protection from energy (375gp)'),
    (70, 'Remove blindness/deafness (375gp)'),
    (73, 'Remove curse (375gp)'),
    (76, 'Remove disease (375gp)'),
    (79, 'Searing light (375gp)'),
    (81, 'Sleet storm (375gp)'),
    (85, 'Speak with dead (375gp)'),
    (87, 'Stone shape (375gp)'),
    (89, 'Summon monster III (375gp)'),
    (91, 'Summon nature\'s ally III (375gp)'),
    (95, 'Water breathing (375gp)'),
    (97, 'Water walk (375gp)'),
    (100, 'Animate dead (625gp)'),
    ]
sd3_uncommon = [
    (4, 'Aqueous orb (375gp)'),
    (8, 'Archon\'s aura (375gp)'),
    (12, 'Bestow insight (375gp)'),
    (16, 'Blindness/deafness (375gp)'),
    (19, 'Burst of nettles (375gp)'),
    (22, 'Chain of perdition (375gp)'),
    (26, 'Contagion (375gp)'),
    (30, 'Create food and water (375gp)'),
    (34, 'Daybreak arrow (375gp)'),
    (36, 'Diminish plants (375gp)'),
    (40, 'Discovery torch (375gp)'),
    (45, 'Dominate animal (375gp)'),
    (48, 'Guiding star (375gp)'),
    (51, 'Helping hand (375gp)'),
    (56, 'Meld into stone (375gp)'),
    (58, 'Obscure object (375gp)'),
    (61, 'Plant growth (375gp)'),
    (64, 'Quench (375gp)'),
    (67, 'Shifting sands (375gp)'),
    (72, 'Snare (375gp)'),
    (75, 'Speak with plants (375gp)'),
    (80, 'Spike growth (375gp)'),
    (83, 'Vision of hell (375gp)'),
    (87, 'Wind wall (375gp)'),
    (90, 'Wrathful mantle (375gp)'),
    (93, 'Continual flame (425gp)'),
    (96, 'Nap stack (475gp)'),
    (98, 'Glyph of warding (575gp)'),
    (100, 'Symbol of healing (875gp)'),
    ]
sd4_common = [
    (4, 'Air walk (700gp)'),
    (7, 'Chaos hammer (700gp)'),
    (15, 'Cure critical wounds (700gp)'),
    (19, 'Death ward (700gp)'),
    (22, 'Dimensional anchor (700gp)'),
    (25, 'Discern lies (700gp)'),
    (28, 'Dismissal (700gp)'),
    (33, 'Divine power (700gp)'),
    (39, 'Flame strike (700gp)'),
    (43, 'Freedom of movement (700gp)'),
    (46, 'Holy smite (700gp)'),
    (51, 'Inflict critical wounds (700gp)'),
    (56, 'Magic weapon, greater (700gp)'),
    (61, 'Neutralize poison (700gp)'),
    (64, 'Order\'s wrath (700gp)'),
    (68, 'Poison (700gp)'),
    (73, 'Spell immunity (700gp)'),
    (77, 'Spike stones (700gp)'),
    (80, 'Summon monster IV (700gp)'),
    (83, 'Summon nature\'s ally IV (700gp)'),
    (86, 'Tongues (700gp)'),
    (89, 'Unholy blight (700gp)'),
    (93, 'Divination (725gp)'),
    (96, 'Planar ally, lesser (1,200gp)'),
    (100, 'Restoration (1,700gp)'),
    ]
sd4_uncommon = [
    (4, 'Absorb toxicity (700gp)'),
    (6, 'Antiplant shell (700gp)'),
    (11, 'Aspect of the stag (700gp)'),
    (15, 'Aura of doom (700gp)'),
    (21, 'Ball lightning (700gp)'),
    (25, 'Blessing of fervor (700gp)'),
    (28, 'Blight (700gp)'),
    (31, 'Command plants (700gp)'),
    (35, 'Control water (700gp)'),
    (39, 'Debilitating portent (700gp)'),
    (43, 'Giant vermin (700gp)'),
    (49, 'Ice storm (700gp)'),
    (55, 'Imbue with spell ability (700gp)'),
    (59, 'Plague carrier (700gp)'),
    (63, 'Planar adaptation (700gp)'),
    (67, 'Protection from energy, communal (700gp)'),
    (72, 'Reincarnate (700gp)'),
    (75, 'Repel vermin (700gp)'),
    (78, 'Rusting grasp (700gp)'),
    (83, 'Scrying (700gp)'),
    (87, 'Sending (700gp)'),
    (90, 'Spiritual ally (700gp)'),
    (93, 'Thorn body (700gp)'),
    (98, 'Volcanic storm (700gp)'),
    (100, 'Symbol of slowing (1,700gp)'),
    ]
sd5_common = [
    (2, 'Animal growth (1,125gp)'),
    (4, 'Atonement (1,125gp)'),
    (7, 'Baleful polymorph (1,125gp)'),
    (11, 'Break enchantment (1,125gp)'),
    (16, 'Breath of life (1,125gp)'),
    (21, 'Call lightning storm (1,125gp)'),
    (25, 'Command, greater (1,125gp)'),
    (30, 'Cure light wounds, mass (1,125gp)'),
    (34, 'Death ward (1,125gp)'),
    (37, 'Disrupting weapon (1,125gp)'),
    (42, 'Inflict light wounds, mass (1,125gp)'),
    (47, 'Plane shift (1,125gp)'),
    (53, 'Righteous might (1,125gp)'),
    (57, 'Scrying (1,125gp)'),
    (62, 'Slay living (1,125gp)'),
    (67, 'Spell resistance (1,125gp)'),
    (70, 'Summon monster V (1,125gp)'),
    (73, 'Summon nature\'s ally V (1,125gp)'),
    (75, 'Tree stride (1,125gp)'),
    (77, 'Wall of fire (1,125gp)'),
    (80, 'Wall of stone (1,125gp)'),
    (82, 'Wall of thorns (1,125gp)'),
    (87, 'True seeing (1,375gp)'),
    (91, 'Commune (1,625gp)'),
    (94, 'Awaken (3,125gp)'),
    (100, 'Raise dead (6,125gp)'),
    ]
sd5_uncommon = [
    (3, 'Air walk, communal (1,125gp)'),
    (8, 'Aspect of the wolf (1,125gp)'),
    (11, 'Blessing of the salamander (1,125gp)'),
    (15, 'Cleanse (1,125gp)'),
    (21, 'Commune with nature (1,125gp)'),
    (24, 'Contagion, greater (1,125gp)'),
    (28, 'Control winds (1,125gp)'),
    (31, 'Dispel chaos (1,125gp)'),
    (34, 'Dispel evil (1,125gp)'),
    (37, 'Dispel good (1,125gp)'),
    (40, 'Dispel law (1,125gp)'),
    (43, 'Fickle winds (1,125gp)'),
    (46, 'Forbid action, greater (1,125gp)'),
    (52, 'Insect plague (1,125gp)'),
    (55, 'Life bubble (1,125gp)'),
    (58, 'Mark of justice (1,125gp)'),
    (63, 'Pillar of life (1,125gp)'),
    (66, 'Serenity (1,125gp)'),
    (72, 'Snake staff (1,125gp)'),
    (76, 'Spell immunity, communal (1,125gp)'),
    (79, 'Transmute mud to rock (1,125gp)'),
    (82, 'Transmute rock to mud (1,125gp)'),
    (86, 'Wind blades (1,125gp)'),
    (90, 'Stoneskin (1,375gp)'),
    (92, 'Hallow (2,125gp)'),
    (94, 'Symbol of pain (2,125gp)'),
    (96, 'Symbol of sleep (2,125gp)'),
    (98, 'Unhallow (2,125gp)'),
    (99, 'Hallow + (4thlvl 6,125gp)'),
    (100, 'Unhallow + (4thlvl 6,125gp)'),
    ]
sd6_common = [
    (5, 'Bear\'s endurance, mass (1,650gp)'),
    (11, 'Blade barrier (1,650gp)'),
    (16, 'Bull\'s strength, mass (1,650gp)'),
    (21, 'Cat\'s grace, mass (1,650gp)'),
    (27, 'Cure moderate wounds, mass (1,650gp)'),
    (32, 'Dispel magic, greater (1,650gp)'),
    (37, 'Eagle\'s splendor, mass (1,650gp)'),
    (43, 'Find the path (1,650gp)'),
    (47, 'Fire seeds (1,650gp)'),
    (55, 'Harm (1,650gp)'),
    (63, 'Heal (1,650gp)'),
    (69, 'Heroes\' feast (1,650gp)'),
    (74, 'Inflict moderate wounds, mass (1,650gp)'),
    (78, 'Liveoak (1,650gp)'),
    (83, 'Owl\'s wisdom, mass (1,650gp)'),
    (87, 'Summon monster VI (1,650gp)'),
    (91, 'Summon nature\'s ally VI (1,650gp)'),
    (96, 'Word of recall (1,650gp)'),
    (100, 'Planar ally (2,900gp)'),
    ]
sd6_uncommon = [
    (5, 'Animate objects (1,650gp)'),
    (9, 'Antilife shell (1,650gp)'),
    (15, 'Banishment (1,650gp)'),
    (19, 'Cold ice strike (1,650gp)'),
    (23, 'Dust form (1,650gp)'),
    (29, 'Geas/quest (1,650gp)'),
    (33, 'Ironwood (1,650gp)'),
    (37, 'Joyful rapture (1,650gp)'),
    (42, 'Move earth (1,650gp)'),
    (46, 'Plague storm (1,650gp)'),
    (51, 'Planar adaptation, mass (1,650gp)'),
    (54, 'Repel wood (1,650gp)'),
    (59, 'Sirocco (1,650gp)'),
    (63, 'Spellstaff (1,650gp)'),
    (67, 'Stone tell (1,650gp)'),
    (70, 'Swarm skin (1,650gp)'),
    (74, 'Tar pool (1,650gp)'),
    (77, 'Transport via plants (1,650gp)'),
    (83, 'Wind walk (1,650gp)'),
    (86, 'Create undead (1,750gp)'),
    (90, 'Glyph of warding, greater (2,050gp)'),
    (92, 'Undeath to death (2,150gp)'),
    (95, 'Symbol of fear (2,650gp)'),
    (98, 'Forbiddance (4,650gp)'),
    (100, 'Symbol of persuasion (6,650gp)'),
    ]
sd7_common = [
    (4, 'Blasphemy (2,275gp)'),
    (10, 'Control weather (2,275gp)'),
    (17, 'Creeping doom (2,275gp)'),
    (24, 'Cure serious wounds, mass (2,275gp)'),
    (28, 'Dictum (2,275gp)'),
    (33, 'Ethereal jaunt (2,275gp)'),
    (40, 'Fire storm (2,275gp)'),
    (44, 'Holy word (2,275gp)'),
    (50, 'Inflict serious wounds, mass (2,275gp)'),
    (55, 'Regenerate (2,275gp)'),
    (60, 'Repulsion (2,275gp)'),
    (65, 'Scrying, greater (2,275gp)'),
    (69, 'Summon monster VII (2,275gp)'),
    (73, 'Summon nature\'s ally VII (2,275gp)'),
    (78, 'Sunbeam (2,275gp)'),
    (82, 'Word of chaos (2,275gp)'),
    (89, 'Destruction (2,775gp)'),
    (94, 'Restoration, greater (7,275gp)'),
    (100, 'Resurrection (12,275gp)'),
    ]
sd7_uncommon = [
    (8, 'Animate plants (2,275gp)'),
    (17, 'Changestaff (2,275gp)'),
    (24, 'Circle of clarity (2,275gp)'),
    (30, 'Create demiplane, lesser (2,275gp)'),
    (38, 'Jolting portent (2,275gp)'),
    (45, 'Rampart (2,275gp)'),
    (53, 'Scouring winds (2,275gp)'),
    (60, 'Siege of trees (2,275gp)'),
    (67, 'Transmute metal to wood (2,275gp)'),
    (76, 'Vortex (2,275gp)'),
    (83, 'Waves of ecstasy (2,275gp)'),
    (89, 'Refuge (3,775gp)'),
    (95, 'Symbol of stunning (7,275gp)'),
    (100, 'Symbol of weakness (7,275gp)'),
    ]
sd8_common = [
    (8, 'Antimagic field (3,000gp)'),
    (14, 'Cloak of chaos (3,000gp)'),
    (23, 'Cure critical wounds, mass (3,000gp)'),
    (31, 'Earthquake (3,000gp)'),
    (38, 'Finger of death (3,000gp)'),
    (44, 'Holy aura (3,000gp)'),
    (51, 'Inflict critical wounds, mass (3,000gp)'),
    (59, 'Reverse gravity (3,000gp)'),
    (65, 'Shield of law (3,000gp)'),
    (73, 'Spell immunity, greater (3,000gp)'),
    (78, 'Summon monster VIII (3,000gp)'),
    (83, 'Summon nature\'s ally VIII (3,000gp)'),
    (89, 'Sunburst (3,000gp)'),
    (95, 'Unholy aura (3,000gp)'),
    (100, 'Planar ally, greater (5,500gp)'),
    ]
sd8_uncommon = [
    (7, 'Animal shapes (3,000gp)'),
    (13, 'Blood mist (3,000gp)'),
    (18, 'Control plants (3,000gp)'),
    (24, 'Create demiplane (3,000gp)'),
    (31, 'Dimensional lock (3,000gp)'),
    (37, 'Discern location (3,000gp)'),
    (42, 'Euphoric tranquility (3,000gp)'),
    (49, 'Frightful aspect (3,000gp)'),
    (56, 'Orb of the void (3,000gp)'),
    (61, 'Repel metal or stone (3,000gp)'),
    (68, 'Seamantle (3,000gp)'),
    (75, 'Storm bolts (3,000gp)'),
    (83, 'Whirlwind (3,000gp)'),
    (88, 'Create greater undead (3,150gp)'),
    (95, 'Symbol of death (8,000gp)'),
    (100, 'Symbol of insanity (8,000gp)'),
    ]
sd9_common = [
    (7, 'Elemental swarm (3,825gp)'),
    (15, 'Energy drain (3,825gp)'),
    (22, 'Etherealness (3,825gp)'),
    (30, 'Gate (3,825gp)'),
    (40, 'Heal, mass (3,825gp)'),
    (48, 'Implosion (3,825gp)'),
    (58, 'Miracle (3,825gp)'),
    (65, 'Shambler (3,825gp)'),
    (73, 'Shapechange (3,825gp)'),
    (81, 'Storm of vengeance (3,825gp)'),
    (87, 'Summon monster IX (3,825gp)'),
    (93, 'Summon nature\'s ally IX (3,825gp)'),
    (100, 'True resurrection (28,825gp)'),
    ]
sd9_uncommon = [
    (8, 'Antipathy (3,825gp)'),
    (15, 'Clashing rocks (3,825gp)'),
    (22, 'Create demiplane, greater (3,825gp)'),
    (31, 'Foresight (3,825gp)'),
    (39, 'Overwhelming presence (3,825gp)'),
    (47, 'Polar midnight (3,825gp)'),
    (56, 'Soul bind (3,825gp)'),
    (64, 'Spell immunity, greater (3,825gp)'),
    (71, 'Summon froghemoth (3,825gp)'),
    (80, 'Winds of vengeance (3,825gp)'),
    (87, 'World wave (3,825gp)'),
    (94, 'Astral projection (4,825gp)'),
    (100, 'Sympathy (5,325gp)'),
    ]


def scrollinator(level, *quad):
    def inner():
        combo = zip(('Arcane', 'Arcane', 'Divine', 'Divine'), quad)
        realm, chart = roll(zip((45, 60, 90, 100), combo))
        return '%s Scroll "%s" (%s)' % (realm, recurse(chart), level)
    return inner

s0 = scrollinator('0th', sa0_common, sa0_uncommon, sd0_common, sd0_uncommon)
s1 = scrollinator('1st', sa1_common, sa1_uncommon, sd1_common, sd1_uncommon)
s2 = scrollinator('2nd', sa2_common, sa2_uncommon, sd2_common, sd2_uncommon)
s3 = scrollinator('3rd', sa3_common, sa3_uncommon, sd3_common, sd3_uncommon)
s4 = scrollinator('4th', sa4_common, sa4_uncommon, sd4_common, sd4_uncommon)
s5 = scrollinator('5th', sa5_common, sa5_uncommon, sd5_common, sd5_uncommon)
s6 = scrollinator('6th', sa6_common, sa6_uncommon, sd6_common, sd6_uncommon)
s7 = scrollinator('7th', sa7_common, sa7_uncommon, sd7_common, sd7_uncommon)
s8 = scrollinator('8th', sa8_common, sa8_uncommon, sd8_common, sd8_uncommon)
s9 = scrollinator('9th', sa9_common, sa9_uncommon, sd9_common, sd9_uncommon)
lmin_scroll = [
    (15, s0),
    (95, s1),
    (100, s2),
    ]
gmin_scroll = [
    (5, s0),
    (35, s1),
    (90, s2),
    (100, s3),
    ]
lmed_scroll = [
    (10, s2),
    (55, s3),
    (100, s4),
    ]
gmed_scroll = [
    (20, s3),
    (60, s4),
    (100, s5),
    ]
lmaj_scroll = [
    (30, s4),
    (65, s5),
    (90, s6),
    (100, s7),
    ]
gmaj_scroll = [
    (5, s6),
    (35, s7),
    (70, s8),
    (100, s9),
    ]
scroll = (
    lambda: roll(zip((66, 100), (lmin_scroll, gmin_scroll))),
    lambda: roll(zip((66, 100), (lmed_scroll, gmed_scroll))),
    lambda: roll(zip((66, 100), (lmaj_scroll, gmaj_scroll))),
    )

lmed_staff = [
    (10, 'Staff of Blessed Relief (7,200gp)'),
    (20, 'Staff of Minor Arcana (8,000gp)'),
    (30, 'Staff of Tricks (8,800gp)'),
    (44, 'Staff of The Scout (9,600gp)'),
    (54, 'Staff of Eidolons (14,400gp)'),
    (67, 'Staff of Accompaniment (14,800gp)'),
    (84, 'Staff of Understanding (16,000gp)'),
    (100, 'Staff of Charming (17,600gp)'),
    ]
gmed_staff = [
    (11, 'Staff of Fire (18,950gp)'),
    (21, 'Staff of Courage (19,200gp)'),
    (29, 'Staff of Belittling (20,000gp)'),
    (38, 'Staff of Feast and Famine (20,800gp)'),
    (49, 'Staff of Rigor (20,800gp)'),
    (60, 'Staff of Swarming Insects (22,800gp)'),
    (68, 'Staff of Authority (23,000gp)'),
    (81, 'Staff of Radiance (23,200gp)'),
    (92, 'Staff of Size Alteration (26,150gp)'),
    (100, 'Staff of Journeys (27,200gp)'),
    ]
lmaj_staff = [
    (4, 'Staff of Acid (28,600gp)'),
    (8, 'Staff of Shrieking (28,800gp)'),
    (11, 'Chaotic Staff (29,600gp)'),
    (14, 'Holy Staff (29,600gp)'),
    (17, 'Lawful Staff (29,600gp)'),
    (21, 'Staff of Healing (29,600gp)'),
    (24, 'Unholy Staff (29,600gp)'),
    (28, 'Staff of the Master (30,000gp)'),
    (32, 'Staff of Spiders (30,200gp)'),
    (36, 'Staff of Electricity (31,900gp)'),
    (39, 'Heretic\'s Bane (32,000gp)'),
    (42, 'Musical Staff (32,000gp)'),
    (46, 'Staff of Souls (32,800gp)'),
    (50, 'Staff of Toxins (34,200gp)'),
    (54, 'Staff of Stealth (36,800gp)'),
    (58, 'Staff of the Avenger (37,310gp)'),
    (62, 'Staff of Aspects (37,600gp)'),
    (66, 'Staff of Speaking (39,600gp)'),
    (70, 'Staff of Frost (41,400gp)'),
    (74, 'Staff of Bolstering (41,600gp)'),
    (78, 'Staff of Curses (43,500gp)'),
    (85, 'Staff of Dark Flame (47,000gp)'),
    (89, 'Staff of Cackling Wrath (47,200gp)'),
    (93, 'Staff of Performance (48,800gp)'),
    (97, 'Animate Staff (49,800gp)'),
    (100, 'Staff of Revelations (51,008gp)'),
    ]
gmaj_staff = [
    (4, 'Staff of Illumination (51,500gp)'),
    (7, 'Staff of Obstacles (51,600gp)'),
    (10, 'Staff of Heaven and Earth (54,000gp)'),
    (13, 'Staff of Travel (54,400gp)'),
    (16, 'Staff of Hoarding (55,866gp)'),
    (19, 'Staff of Traps (56,925gp)'),
    (22, 'Staff of Many Rays (57,200gp)'),
    (25, 'Staff of Mithral Might (58,000gp)'),
    (29, 'Staff of Defense (62,000gp)'),
    (32, 'Staff of The Planes (63,960gp)'),
    (35, 'Staff of Hungry Shadows (69,300gp)'),
    (38, 'Dragon Staff (81,000gp)'),
    (41, 'Staff of Slumber (81,766gp)'),
    (46, 'Staff of Abjuration (82,000gp)'),
    (51, 'Staff of Conjuration (82,000gp)'),
    (56, 'Staff of Divination (82,000gp)'),
    (61, 'Staff of Enchantment (82,000gp)'),
    (66, 'Staff of Evocation (82,000gp)'),
    (71, 'Staff of Illusion (82,000gp)'),
    (76, 'Staff of Necromancy (82,000gp)'),
    (81, 'Staff of Transmutation (82,000gp)'),
    (83, 'Staff of Weather (84,066gp)'),
    (86, 'Staff of Earth and Stone (85,800gp)'),
    (88, 'Staff of Vision (86,666gp)'),
    (91, 'Staff of The Woodlands (100,400gp)'),
    (94, 'Staff of Life (109,400gp)'),
    (95, 'Staff of One Hundred Hands (180,200gp)'),
    (98, 'Staff of Passage (206,900gp)'),
    (99, 'Staff of the Hierophant (220,000gp)'),
    (100, 'Staff of Power (235,000gp)'),
    ]
staff = (
    (None),
    lambda: roll(zip((66, 100), (lmed_staff, gmed_staff))),
    lambda: roll(zip((66, 100), (lmaj_staff, gmaj_staff))),
    )

w0_common = [
    (7, 'Acid splash (375gp)'),
    (14, 'Create water (375gp)'),
    (20, 'Daze (375gp)'),
    (28, 'Detect magic (375gp)'),
    (34, 'Ghost sound (375gp)'),
    (42, 'Light (375gp)'),
    (49, 'Mage hand (375gp)'),
    (55, 'Mending (375gp)'),
    (60, 'Message (375gp)'),
    (66, 'Prestidigitation (375gp)'),
    (73, 'Purify food and drink (375gp)'),
    (81, 'Ray of frost (375gp)'),
    (88, 'Read magic (375gp)'),
    (95, 'Stabilize (375gp)'),
    (100, 'Touch of fatigue (375gp)'),
    ]
w0_uncommon = [
    (6, 'Arcane mark (375gp)'),
    (15, 'Bleed (375gp)'),
    (22, 'Dancing lights (375gp)'),
    (31, 'Detect poison (375gp)'),
    (40, 'Disrupt undead (375gp)'),
    (48, 'Flare (375gp)'),
    (56, 'Guidance (375gp)'),
    (65, 'Know direction (375gp)'),
    (73, 'Lullaby (375gp)'),
    (79, 'Open/close (375gp)'),
    (86, 'Resistance (375gp)'),
    (94, 'Spark (375gp)'),
    (100, 'Virtue (375gp)'),
    ]
w1_common = [
    (2, 'Alarm (750gp)'),
    (3, 'Animate rope (750gp)'),
    (5, 'Bane (750gp)'),
    (11, 'Bless (750gp)'),
    (14, 'Burning hands (750gp)'),
    (17, 'Cause fear (750gp)'),
    (19, 'Charm person (750gp)'),
    (21, 'Color spray (750gp)'),
    (23, 'Command (750gp)'),
    (24, 'Comprehend languages (750gp)'),
    (31, 'Cure light wounds (750gp)'),
    (33, 'Disguise self (750gp)'),
    (37, 'Divine favor (750gp)'),
    (38, 'Endure elements (750gp)'),
    (41, 'Enlarge person (750gp)'),
    (43, 'Entangle (750gp)'),
    (45, 'Expeditious retreat (750gp)'),
    (46, 'Feather fall (750gp)'),
    (48, 'Grease (750gp)'),
    (50, 'Identify (750gp)'),
    (52, 'Inflict light wounds (750gp)'),
    (58, 'Mage armor (750gp)'),
    (60, 'Magic fang (750gp)'),
    (67, 'Magic missile (750gp)'),
    (68, 'Magic stone (750gp)'),
    (70, 'Magic weapon (750gp)'),
    (71, 'Obscuring mist (750gp)'),
    (73, 'Produce flame (750gp)'),
    (74, 'Protection from chaos (750gp)'),
    (75, 'Protection from evil (750gp)'),
    (76, 'Protection from good (750gp)'),
    (77, 'Protection from law (750gp)'),
    (79, 'Ray of enfeeblement (750gp)'),
    (81, 'Remove fear (750gp)'),
    (84, 'Shield (750gp)'),
    (86, 'Shield of faith (750gp)'),
    (87, 'Shillelagh (750gp)'),
    (89, 'Shocking grasp (750gp)'),
    (90, 'Silent image (750gp)'),
    (94, 'Sleep (750gp)'),
    (95, 'Summon monster I (750gp)'),
    (96, 'Summon nature\'s ally I (750gp)'),
    (99, 'True strike (750gp)'),
    (100, 'Unseen servant (750gp)'),
    ]
w1_uncommon = [
    (2, 'Ant haul (750gp)'),
    (5, 'Aspect of the falcon (750gp)'),
    (7, 'Bless weapon (750gp)'),
    (8, 'Calm animals (750gp)'),
    (10, 'Charm animal (750gp)'),
    (12, 'Chill touch (750gp)'),
    (14, 'Compel hostility (750gp)'),
    (17, 'Confusion, lesser (750gp)'),
    (19, 'Corrosive touch (750gp)'),
    (21, 'Deathwatch (750gp)'),
    (22, 'Detect animals or plants (750gp)'),
    (23, 'Detect chaos (750gp)'),
    (24, 'Detect evil (750gp)'),
    (25, 'Detect good (750gp)'),
    (26, 'Detect law (750gp)'),
    (28, 'Detect secret doors (750gp)'),
    (29, 'Detect snares and pits (750gp)'),
    (31, 'Detect undead (750gp)'),
    (35, 'Doom (750gp)'),
    (37, 'Entropic shield (750gp)'),
    (38, 'Erase (750gp)'),
    (39, 'Faerie fire (750gp)'),
    (41, 'Feather step (750gp)'),
    (44, 'Floating disk (750gp)'),
    (47, 'Goodberry (750gp)'),
    (49, 'Hide from animals (750gp)'),
    (51, 'Hide from undead (750gp)'),
    (52, 'Hideous laughter (750gp)'),
    (54, 'Hold portal (750gp)'),
    (56, 'Hypnotism (750gp)'),
    (58, 'Icicle dagger (750gp)'),
    (60, 'Ill omen (750gp)'),
    (63, 'Jump (750gp)'),
    (65, 'Longstrider (750gp)'),
    (66, 'Magic aura (750gp)'),
    (68, 'Mount (750gp)'),
    (69, 'Obscure object (750gp)'),
    (71, 'Pass without trace (750gp)'),
    (72, 'Ray of sickening (750gp)'),
    (75, 'Reduce person (750gp)'),
    (78, 'Sanctuary (750gp)'),
    (80, 'Shock shield (750gp)'),
    (83, 'Speak with animals (750gp)'),
    (85, 'Stone fist (750gp)'),
    (87, 'Stone shield (750gp)'),
    (88, 'Summon minor monster (750gp)'),
    (89, 'Undetectable alignment (750gp)'),
    (92, 'Urban grace (750gp)'),
    (96, 'Vanish (750gp)'),
    (97, 'Ventriloquism (750gp)'),
    (98, 'Magic mouth (1,250gp)'),
    (99, 'Bless water (2,000gp)'),
    (100, 'Curse water (2,000gp)'),
    ]
w2_common = [
    (2, 'Acid arrow (4,500gp)'),
    (3, 'Aid (4,500gp)'),
    (5, 'Alter self (4,500gp)'),
    (7, 'Barkskin (4,500gp)'),
    (10, 'Bear\'s endurance (4,500gp)'),
    (11, 'Blur (4,500gp)'),
    (14, 'Bull\'s strength (4,500gp)'),
    (16, 'Cat\'s grace (4,500gp)'),
    (22, 'Cure moderate wounds (4,500gp)'),
    (25, 'Darkness (4,500gp)'),
    (26, 'Darkvision (4,500gp)'),
    (27, 'Delay poison (4,500gp)'),
    (29, 'Eagle\'s splendor (4,500gp)'),
    (30, 'False life (4,500gp)'),
    (31, 'Find traps (4,500gp)'),
    (32, 'Flame blade (4,500gp)'),
    (33, 'Flaming sphere (4,500gp)'),
    (35, 'Fog cloud (4,500gp)'),
    (37, 'Fox\'s cunning (4,500gp)'),
    (38, 'Glitterdust (4,500gp)'),
    (40, 'Heat metal (4,500gp)'),
    (43, 'Hold person (4,500gp)'),
    (46, 'Inflict moderate wounds (4,500gp)'),
    (51, 'Invisibility (4,500gp)'),
    (52, 'Knock (4,500gp)'),
    (54, 'Levitate (4,500gp)'),
    (55, 'Minor image (4,500gp)'),
    (57, 'Mirror image (4,500gp)'),
    (59, 'Owl\'s wisdom (4,500gp)'),
    (60, 'Pyrotechnics (4,500gp)'),
    (61, 'Remove paralysis (4,500gp)'),
    (64, 'Resist energy (4,500gp)'),
    (66, 'Restoration, lesser (4,500gp)'),
    (71, 'Scorching ray (4,500gp)'),
    (73, 'See invisibility (4,500gp)'),
    (74, 'Shatter (4,500gp)'),
    (76, 'Shield other (4,500gp)'),
    (78, 'Silence (4,500gp)'),
    (81, 'Sound burst (4,500gp)'),
    (83, 'Spider climb (4,500gp)'),
    (86, 'Spiritual weapon (4,500gp)'),
    (88, 'Summon monster II (4,500gp)'),
    (90, 'Summon nature\'s ally II (4,500gp)'),
    (92, 'Summon swarm (4,500gp)'),
    (96, 'Web (4,500gp)'),
    (97, 'Whispering wind (4,500gp)'),
    (99, 'Augury (5,750gp)'),
    (100, 'Fire trap (5,750gp)'),
    ]
w2_uncommon = [
    (2, 'Align weapon (4,500gp)'),
    (5, 'Animal aspect (4,500gp)'),
    (6, 'Animal messenger (4,500gp)'),
    (7, 'Animal trance (4,500gp)'),
    (10, 'Aspect of the bear (4,500gp)'),
    (13, 'Bestow weapon proficiency (4,500gp)'),
    (15, 'Blindness/deafness (4,500gp)'),
    (18, 'Burning gaze (4,500gp)'),
    (21, 'Calm emotions (4,500gp)'),
    (24, 'Chill metal (4,500gp)'),
    (25, 'Command undead (4,500gp)'),
    (27, 'Daze monster (4,500gp)'),
    (29, 'Death knell (4,500gp)'),
    (32, 'Defensive shock (4,500gp)'),
    (33, 'Delay pain (4,500gp)'),
    (35, 'Detect thoughts (4,500gp)'),
    (39, 'Disguise other (4,500gp)'),
    (42, 'Effortless armor (4,500gp)'),
    (46, 'Elemental touch (4,500gp)'),
    (48, 'Enthrall (4,500gp)'),
    (50, 'Gentle repose (4,500gp)'),
    (51, 'Ghoul touch (4,500gp)'),
    (53, 'Glide (4,500gp)'),
    (55, 'Groundswell (4,500gp)'),
    (56, 'Gust of wind (4,500gp)'),
    (57, 'Hold animal (4,500gp)'),
    (59, 'Hypnotic pattern (4,500gp)'),
    (60, 'Locate object (4,500gp)'),
    (61, 'Make whole (4,500gp)'),
    (63, 'Misdirection (4,500gp)'),
    (65, 'Oppressive boredom (4,500gp)'),
    (66, 'Protection from arrows (4,500gp)'),
    (67, 'Reduce animal (4,500gp)'),
    (69, 'Rope trick (4,500gp)'),
    (72, 'Scare (4,500gp)'),
    (74, 'Share language (4,500gp)'),
    (76, 'Soften earth and stone (4,500gp)'),
    (78, 'Spectral hand (4,500gp)'),
    (80, 'Status (4,500gp)'),
    (82, 'Tongues (4,500gp)'),
    (84, 'Touch of idiocy (4,500gp)'),
    (86, 'Tree shape (4,500gp)'),
    (88, 'Warp wood (4,500gp)'),
    (91, 'Weapon of awe (4,500gp)'),
    (93, 'Wood shape (4,500gp)'),
    (95, 'Zone of truth (4,500gp)'),
    (96, 'Arcane lock (5,750gp)'),
    (97, 'Consecrate (5,750gp)'),
    (98, 'Desecrate (5,750gp)'),
    (99, 'Continual flame (7,000gp)'),
    (100, 'Phantom trap (7,000gp)'),
    ]
w3_common = [
    (2, 'Beast shape I (11,250gp)'),
    (4, 'Blink (11,250gp)'),
    (7, 'Call lightning (11,250gp)'),
    (8, 'Create food and water (11,250gp)'),
    (14, 'Cure serious wounds (11,250gp)'),
    (16, 'Daylight (11,250gp)'),
    (18, 'Deep slumber (11,250gp)'),
    (20, 'Deeper darkness (11,250gp)'),
    (25, 'Dispel magic (11,250gp)'),
    (28, 'Displacement (11,250gp)'),
    (34, 'Fireball (11,250gp)'),
    (35, 'Flame arrow (11,250gp)'),
    (37, 'Fly (11,250gp)'),
    (38, 'Gaseous form (11,250gp)'),
    (40, 'Haste (11,250gp)'),
    (42, 'Heroism (11,250gp)'),
    (45, 'Inflict serious wounds (11,250gp)'),
    (47, 'Invisibility purge (11,250gp)'),
    (48, 'Invisibility sphere (11,250gp)'),
    (50, 'Keen edge (11,250gp)'),
    (55, 'Lightning bolt (11,250gp)'),
    (56, 'Magic circle against chaos (11,250gp)'),
    (57, 'Magic circle against evil (11,250gp)'),
    (58, 'Magic circle against good (11,250gp)'),
    (59, 'Magic circle against law (11,250gp)'),
    (60, 'Magic fang, greater (11,250gp)'),
    (62, 'Magic vestment (11,250gp)'),
    (64, 'Magic weapon, greater (11,250gp)'),
    (66, 'Major image (11,250gp)'),
    (70, 'Prayer (11,250gp)'),
    (74, 'Protection from energy (11,250gp)'),
    (75, 'Remove blindness/deafness (11,250gp)'),
    (77, 'Remove curse (11,250gp)'),
    (79, 'Remove disease (11,250gp)'),
    (82, 'Searing light (11,250gp)'),
    (83, 'Sleet storm (11,250gp)'),
    (85, 'Slow (11,250gp)'),
    (87, 'Speak with dead (11,250gp)'),
    (89, 'Stinking cloud (11,250gp)'),
    (90, 'Stone shape (11,250gp)'),
    (92, 'Suggestion (11,250gp)'),
    (93, 'Summon monster III (11,250gp)'),
    (94, 'Summon nature\'s ally III (11,250gp)'),
    (97, 'Vampiric touch (11,250gp)'),
    (99, 'Water breathing (11,250gp)'),
    (100, 'Animate dead (23,750gp)'),
    ]
w3_uncommon = [
    (4, 'Animal aspect, greater (11,250gp)'),
    (6, 'Aqueous orb (11,250gp)'),
    (8, 'Arcane sight (11,250gp)'),
    (11, 'Archon\'s aura (11,250gp)'),
    (14, 'Ash storm (11,250gp)'),
    (17, 'Bestow curse (11,250gp)'),
    (20, 'Clairaudience/clairvoyance (11,250gp)'),
    (22, 'Contagion (11,250gp)'),
    (23, 'Diminish plants (11,250gp)'),
    (25, 'Dominate animal (11,250gp)'),
    (29, 'Elemental aura (11,250gp)'),
    (30, 'Explosive runes (11,250gp)'),
    (34, 'Force punch (11,250gp)'),
    (35, 'Halt undead (11,250gp)'),
    (37, 'Helping hand (11,250gp)'),
    (40, 'Hostile levitation (11,250gp)'),
    (43, 'Howling agony (11,250gp)'),
    (45, 'Hydraulic torrent (11,250gp)'),
    (46, 'Mad monkeys (11,250gp)'),
    (49, 'Meld into stone (11,250gp)'),
    (52, 'Neutralize poison (11,250gp)'),
    (54, 'Pain strike (11,250gp)'),
    (55, 'Phantom steed (11,250gp)'),
    (57, 'Plant growth (11,250gp)'),
    (60, 'Poison (11,250gp)'),
    (61, 'Quench (11,250gp)'),
    (65, 'Rage (11,250gp)'),
    (67, 'Ray of exhaustion (11,250gp)'),
    (69, 'Resinous skin (11,250gp)'),
    (70, 'Secret page (11,250gp)'),
    (71, 'Shrink item (11,250gp)'),
    (73, 'Snare (11,250gp)'),
    (74, 'Speak with plants (11,250gp)'),
    (76, 'Spike growth (11,250gp)'),
    (77, 'Tiny hut (11,250gp)'),
    (81, 'Water walk (11,250gp)'),
    (84, 'Wind wall (11,250gp)'),
    (86, 'Wrathful mantle (11,250gp)'),
    (87, 'Illusory script (13,750gp)'),
    (89, 'Nondetection (13,750gp)'),
    (91, 'Glibness (15,750gp)'),
    (95, 'Good hope (15,750gp)'),
    (97, 'Heal mount (15,750gp)'),
    (98, 'Sculpt sound (15,750gp)'),
    (99, 'Glyph of warding (21,250gp)'),
    (100, 'Sepia snake sigil (36,250gp)'),
    ]
w4_common = [
    (2, 'Air walk (21,000gp)'),
    (4, 'Beast shape II (21,000gp)'),
    (7, 'Black tentacles (21,000gp)'),
    (8, 'Chaos hammer (21,000gp)'),
    (11, 'Charm monster (21,000gp)'),
    (14, 'Confusion (21,000gp)'),
    (16, 'Crushing despair (21,000gp)'),
    (22, 'Cure critical wounds (21,000gp)'),
    (24, 'Death ward (21,000gp)'),
    (28, 'Dimension door (21,000gp)'),
    (29, 'Dimensional anchor (21,000gp)'),
    (30, 'Dismissal (21,000gp)'),
    (33, 'Divine power (21,000gp)'),
    (35, 'Elemental body I (21,000gp)'),
    (37, 'Enervation (21,000gp)'),
    (39, 'Enlarge person, mass (21,000gp)'),
    (42, 'Fear (21,000gp)'),
    (44, 'Fire shield (21,000gp)'),
    (48, 'Flame strike (21,000gp)'),
    (51, 'Freedom of movement (21,000gp)'),
    (53, 'Globe of invulnerability, lesser (21,000gp)'),
    (54, 'Holy smite (21,000gp)'),
    (56, 'Ice storm (21,000gp)'),
    (58, 'Imbue with spell ability (21,000gp)'),
    (61, 'Inflict critical wounds (21,000gp)'),
    (65, 'Invisibility, greater (21,000gp)'),
    (66, 'Order\'s wrath (21,000gp)'),
    (69, 'Phantasmal killer (21,000gp)'),
    (70, 'Resilient sphere (21,000gp)'),
    (72, 'Scrying (21,000gp)'),
    (73, 'Sending (21,000gp)'),
    (74, 'Shout (21,000gp)'),
    (76, 'Solid fog (21,000gp)'),
    (79, 'Spell immunity (21,000gp)'),
    (80, 'Summon monster IV (21,000gp)'),
    (81, 'Summon nature\'s ally IV (21,000gp)'),
    (82, 'Unholy blight (21,000gp)'),
    (87, 'Wall of fire (21,000gp)'),
    (91, 'Wall of ice (21,000gp)'),
    (93, 'Divination (22,250gp)'),
    (95, 'Restoration (26,000gp)'),
    (96, 'Break enchantment (30,000gp)'),
    (98, 'Stoneskin (33,500gp)'),
    (99, 'Planar ally, lesser (46,000gp)'),
    (100, 'Restoration* (71,000gp)'),
    ]
w4_uncommon = [
    (1, 'Antiplant shell (21,000gp)'),
    (4, 'Arcane eye (21,000gp)'),
    (7, 'Aspect of the stag (21,000gp)'),
    (11, 'Ball lightning (21,000gp)'),
    (12, 'Blight (21,000gp)'),
    (13, 'Command plants (21,000gp)'),
    (15, 'Control water (21,000gp)'),
    (18, 'Darkvision, greater (21,000gp)'),
    (19, 'Detect scrying (21,000gp)'),
    (20, 'Discern lies (21,000gp)'),
    (24, 'Dragon\'s breath (21,000gp)'),
    (28, 'False life, greater (21,000gp)'),
    (30, 'Geas, lesser (21,000gp)'),
    (34, 'Ghost wolf (21,000gp)'),
    (36, 'Giant vermin (21,000gp)'),
    (37, 'Hallucinatory terrain (21,000gp)'),
    (38, 'Illusory wall (21,000gp)'),
    (40, 'Locate creature (21,000gp)'),
    (42, 'Minor creation (21,000gp)'),
    (43, 'Mnemonic enhancer (21,000gp)'),
    (46, 'Obsidian flow (21,000gp)'),
    (48, 'Rainbow pattern (21,000gp)'),
    (50, 'Reduce person, mass (21,000gp)'),
    (53, 'Reincarnate (21,000gp)'),
    (54, 'Repel vermin (21,000gp)'),
    (56, 'Ride the waves (21,000gp)'),
    (59, 'Rusting grasp (21,000gp)'),
    (60, 'Secure shelter (21,000gp)'),
    (63, 'Shadow conjuration (21,000gp)'),
    (67, 'Shadow step (21,000gp)'),
    (70, 'Shocking image (21,000gp)'),
    (74, 'Spike stones (21,000gp)'),
    (76, 'Volcanic storm (21,000gp)'),
    (79, 'Wandering star motes (21,000gp)'),
    (80, 'Animal growth (30,000gp)'),
    (82, 'Commune with nature (30,000gp)'),
    (83, 'Dispel chaos (30,000gp)'),
    (84, 'Dispel evil (30,000gp)'),
    (87, 'Dominate person (30,000gp)'),
    (91, 'Hold monster (30,000gp)'),
    (94, 'Holy sword (30,000gp)'),
    (95, 'Mark of justice (30,000gp)'),
    (97, 'Modify memory (30,000gp)'),
    (98, 'Tree stride (30,000gp)'),
    (99, 'Zone of silence (30,000gp)'),
    (100, 'Legend lore (33,500gp)'),
    ]
w0 = lambda: 'Wand of "%s" (0th)' % roll(random.choice((w0_common, w0_common, w0_common, w0_uncommon)))
w1 = lambda: 'Wand of "%s" (1st)' % roll(random.choice((w1_common, w1_common, w1_common, w1_uncommon)))
w2 = lambda: 'Wand of "%s" (2nd)' % roll(random.choice((w2_common, w2_common, w2_common, w2_uncommon)))
w3 = lambda: 'Wand of "%s" (3rd)' % roll(random.choice((w3_common, w3_common, w3_common, w3_uncommon)))
w4 = lambda: 'Wand of "%s" (4th)' % roll(random.choice((w3_common, w3_common, w3_common, w3_uncommon)))

lmin_wand = [
        (40, w0),
        (100, w1),
        ]
gmin_wand = [
        (80, w1),
        (100, w2),
        ]
lmed_wand = [
        (75, w2),
        (100, w3),
        ]
gmed_wand = [
        (20, w2),
        (80, w3),
        (100, w4),
        ]
lmaj_wand = [
        (60, w3),
        (100, w4),
        ]
gmaj_wand = [
        (30, w3),
        (100, w4),
        ]
wand = (
    lambda: roll(zip((66, 100), (lmin_wand, gmin_wand))),
    lambda: roll(zip((66, 100), (lmed_wand, gmed_wand))),
    lambda: roll(zip((66, 100), (lmaj_wand, gmaj_wand))),
    )


lmin_belt = [
    (16, '''Belt of tumbling (800gp)'''),
    (28, '''Beneficial bandolier (1,000gp)'''),
    (40, '''Meridian belt (1,000gp)'''),
    (54, '''Bladed belt (2,000gp)'''),
    (70, '''Heavyload belt (2,000gp)'''),
    (84, '''Aquatic cummerbund (2,600gp)'''),
    (100, '''Equestrian belt (3,200gp)'''),
    ]
gmin_belt = [
    (18, '''Belt of giant strength +2 (4,000gp)'''),
    (36, '''Belt of incredible dexterity +2 (4,000gp)'''),
    (54, '''Belt of mighty constitution +2 (4,000gp)'''),
    (62, '''Belt of teeth (4,000gp)'''),
    (74, '''Blinkback belt (5,000gp)'''),
    (84, '''Plague rat belt (5,200gp)'''),
    (100, '''Belt of foraging (6,000gp)'''),
    ]
lmed_belt = [
    (4, '''Serpent belt (9,000gp)'''),
    (8, '''Monkey belt (9,400gp)'''),
    (16, '''Belt of physical might +2 (10,000gp)'''),
    (22, '''Belt of the weasel (10,000gp)'''),
    (27, '''Belt of thunderous charging (10,000gp)'''),
    (32, '''Minotaur belt (11,000gp)'''),
    (36, '''Plague rat belt, greater (11,200gp)'''),
    (41, '''Belt of equilibrium (12,000gp)'''),
    (46, '''Security belt (12,500gp)'''),
    (51, '''Belt of mighty hurling, lesser (14,000gp)'''),
    (57, '''Belt of dwarvenkind (14,900gp)'''),
    (61, '''Cord of stubborn resolve (15,000gp)'''),
    (71, '''Belt of giant strength +4 (16,000gp)'''),
    (80, '''Belt of physical perfection +2 (16,000gp)'''),
    (90, '''Belt of incredible dexterity +4 (16,000gp)'''),
    (100, '''Belt of mighty constitution +4 (16,000gp)'''),
    ]
gmed_belt = [
    (12, '''Monkey belt, greater (18,000gp)'''),
    (26, '''Anaconda's coils (18,500gp)'''),
    (38, '''Serpent belt, greater (20,000gp)'''),
    (53, '''Belt of fallen heroes (21,000gp)'''),
    (67, '''Gorgon belt (23,000gp)'''),
    (84, '''Elemental earth belt (24,000gp)'''),
    (100, '''Sash of flowing water (25,000gp)'''),
    ]
lmaj_belt = [
    (12, '''Merform belt (32,000gp)'''),
    (30, '''Belt of giant strength +6 (36,000gp)'''),
    (48, '''Belt of incredible dexterity +6 (36,000gp)'''),
    (66, '''Belt of mighty constitution +6 (36,000gp)'''),
    (88, '''Belt of physical might +4 (40,000gp)'''),
    (100, '''Belt of mighty hurling, greater (42,000gp)'''),
    ]
gmaj_belt = [
    (25, '''Belt of stoneskin (60,000gp)'''),
    (55, '''Belt of physical perfection +4 (64,000gp)'''),
    (75, '''Belt of physical might +6 (90,000gp)'''),
    (90, '''Shadowform belt (110,000gp)'''),
    (100, '''Belt of physical perfection +6 (144,000gp)'''),
    ]

lmin_body = [
    (20, '''Robe of infinite twine (1,000gp)'''),
    (35, '''Robe of needles (1,000gp)'''),
    (60, '''Robe of bones (2,400gp)'''),
    (70, '''Bodywrap of mighty strikes +1 (3,000gp)'''),
    (80, '''Corset of the vishkanya (3,000gp)'''),
    (100, '''Druid's vestment (3,750gp)'''),
    ]
gmin_body = [
    (15, '''Cassock of the clergy (4,600gp)'''),
    (30, '''Mnemonic vestments (5,000gp)'''),
    (45, '''Robe of components (5,000gp)'''),
    (60, '''Sorcerer's robe (5,000gp)'''),
    (75, '''Eidolon anchoring harness (6,000gp)'''),
    (100, '''Robe of useful items (7,000gp)'''),
    ]
lmed_body = [
    (15, '''Robe of blending (8,400gp)'''),
    (26, '''Blazing robes (11,000gp)'''),
    (37, '''Shocking robe (11,000gp)'''),
    (48, '''Voidfrost robes (11,000gp)'''),
    (59, '''Bodywrap of mighty strikes +2 (12,000gp)'''),
    (75, '''Monk's robe (13,000gp)'''),
    (100, '''Robe of arcane heritage (16,000gp)'''),
    ]
gmed_body = [
    (25, '''Xorn robe (20,000gp)'''),
    (52, '''Corset of dire witchcraft (22,000gp)'''),
    (76, '''Bodywrap of mighty strikes +3 (27,000gp)'''),
    (100, '''Robe of scintillating colors (27,000gp)'''),
    ]
lmaj_body = [
    (40, '''Gunman's duster (36,000gp)'''),
    (80, '''Bodywrap of mighty strikes +4 (48,000gp)'''),
    (100, '''Smuggler's collapsible robe (48,000gp)'''),
    ]
gmaj_body = [
    (10, '''Robe of stars (58,000gp)'''),
    (15, '''Robe of gates (64,000gp)'''),
    (20, '''Otherworldly kimono (67,000gp)'''),
    (40, '''Bodywrap of mighty strikes +5 (75,000gp)'''),
    (51, '''Resplendent robe of the thespian (75,000gp)'''),
    (67, '''Robe of the archmagi (75,000gp)'''),
    (77, '''Bodywrap of mighty strikes +6 (108,000gp)'''),
    (97, '''Robe of eyes (120,000gp)'''),
    (100, '''Bodywrap of mighty strikes +7 (147,000gp)'''),
    ]

lmin_chest = [
    (15, '''Bandages of rapid recovery (200gp)'''),
    (30, '''Quick runner's shirt (1,000gp)'''),
    (50, '''Endless bandolier (1,500gp)'''),
    (75, '''All tools vest (1,800gp)'''),
    (100, '''Vest of surgery (3,000gp)'''),
    ]
gmin_chest = [
    (10, '''Sash of the war champion (4,000gp)'''),
    (20, '''Sipping jacket (5,000gp)'''),
    (31, '''Tunic of careful casting (5,000gp)'''),
    (42, '''Vest of escape (5,200gp)'''),
    (52, '''Cackling hag's blouse (6,000gp)'''),
    (62, '''Deadshot vest (6,000gp)'''),
    (70, '''Prophet's pectoral (6,000gp)'''),
    (79, '''Tunic of deadly might (6,000gp)'''),
    (90, '''Vest of the vengeful tracker (6,000gp)'''),
    (100, '''Resplendent uniform coat (7,000gp)'''),
    ]
lmed_chest = [
    (13, '''Shirt of immolation (8,000gp)'''),
    (28, '''Snakeskin tunic (8,000gp)'''),
    (40, '''Bane baldric (10,000gp)'''),
    (60, '''Unfettered shirt (10,000gp)'''),
    (80, '''Poisoner's jacket, lesser (12,000gp)'''),
    (100, '''Vest of the cockroach (16,000gp)'''),
    ]
gmed_chest = [
    (50, '''Vest of stable mutation (20,000gp)'''),
    (100, '''Spectral shroud (26,000gp)'''),
    ]
lmaj_chest = [
    (60, '''Mantle of immortality (50,000gp)'''),
    (100, '''Poisoner's jacket, greater (58,000gp)'''),
    ]
gmaj_chest = [
    (35, '''Merciful baldric (60,000gp)'''),
    (70, '''Mantle of faith (76,000gp)'''),
    (100, '''Mantle of spell resistance (90,000gp)'''),
    ]

lmin_eye = [
    (18, '''Deathwatch eyes (2,000gp)'''),
    (38, '''Eyes of the eagle (2,500gp)'''),
    (58, '''Goggles of minute seeing (2,500gp)'''),
    (72, '''Pirate's eye patch (2,600gp)'''),
    (87, '''Spectacles of understanding (3,000gp)'''),
    (100, '''Lenses of detection (3,500gp)'''),
    ]
gmin_eye = [
    (20, '''Eyes of the owl (4,000gp)'''),
    (44, '''Eyes of keen sight (6,000gp)'''),
    (66, '''Treasure hunter's goggles (6,400gp)'''),
    (84, '''Inquisitor's monocle (6,800gp)'''),
    (100, '''Kinsight goggles (7,500gp)'''),
    ]
lmed_eye = [
    (16, '''Goggles of elvenkind (8,500gp)'''),
    (31, '''Goggles of brilliant light (8,800gp)'''),
    (48, '''Blind man's fold (12,000gp)'''),
    (67, '''Goggles of night (12,000gp)'''),
    (82, '''Lenses of figment piercing (12,000gp)'''),
    (100, '''Arachnid goggles (15,000gp)'''),
    ]
gmed_eye = [
    (21, '''Darklands goggles (20,000gp)'''),
    (40, '''Sniper goggles (20,000gp)'''),
    (58, '''Rainbow lenses (21,000gp)'''),
    (77, '''Annihilation spectacles (25,000gp)'''),
    (100, '''Eyes of doom (25,000gp)'''),
    ]
lmaj_eye = [
    (60, '''Eyes of eyebite (30,000gp)'''),
    (100, '''Sniper goggles, greater (50,000gp)'''),
    ]
gmaj_eye = [
    (18, '''Eyes of charming (56,000gp)'''),
    (34, '''Monocle of the investigator (66,000gp)'''),
    (48, '''Sea tyrant's patch (70,000gp)'''),
    (63, '''Swordmaster's blindfold (80,000gp)'''),
    (77, '''Mindmaster's eyes (95,000gp)'''),
    (90, '''Eyes of the dragon (110,000gp)'''),
    (100, '''Truesight goggles (184,800gp)'''),
    ]

lmin_feet = [
    (11, '''Boots of the cat (1,000gp)'''),
    (22, '''Daredevil boots (1,400gp)'''),
    (31, '''Boots of the enduring march (1,500gp)'''),
    (41, '''Feather step slippers (2,000gp)'''),
    (50, '''Boots of friendly terrain (2,400gp)'''),
    (60, '''Boots of the winterlands (2,500gp)'''),
    (76, '''Boots of elvenkind (2,500gp)'''),
    (85, '''Acrobat slippers (3,000gp)'''),
    (92, '''Horseshoes of speed (3,000gp)'''),
    (100, '''Boots of the mire (3,500gp)'''),
    ]
gmin_feet = [
    (7, '''Burglar boots, minor (4,000gp)'''),
    (13, '''Horseshoes of crushing blows +1 (4,000gp)'''),
    (19, '''Sandals of quick reaction (4,000gp)'''),
    (26, '''Slippers of cloudwalking (4,400gp)'''),
    (40, '''Slippers of spider climbing (4,800gp)'''),
    (46, '''Sandals of the lightest step (5,000gp)'''),
    (60, ''' (5,500gp)'''),
    (68, '''Horseshoes of a zephyr (6,000gp)'''),
    (75, '''Haunted shoes (6,480gp)'''),
    (82, '''Jaunt boots (7,200gp)'''),
    (100, '''Boots of levitation (7,500gp)'''),
    ]
lmed_feet = [
    (8, '''Boots of escape (8,000gp)'''),
    (14, '''Earth root boots (8,000gp)'''),
    (21, '''Nightmare boots (8,500gp)'''),
    (26, '''Nightmare horseshoes (9,000gp)'''),
    (32, '''Caltrop boots (10,000gp)'''),
    (39, '''Tremor boots (10,000gp)'''),
    (47, '''Boots of the mastodon (10,500gp)'''),
    (54, '''Shoes of the lightning leaper (10,500gp)'''),
    (70, '''Boots of speed (12,000gp)'''),
    (77, '''Verdant boots (12,000gp)'''),
    (84, '''Horseshoes of crushing blows +2 (16,000gp)'''),
    (100, '''Winged boots (16,000gp)'''),
    ]
gmed_feet = [
    (38, '''Shoes of the firewalker (21,000gp)'''),
    (72, '''Dryad sandals (24,000gp)'''),
    (100, '''Horseshoes of the mist (27,000gp)'''),
    ]
lmaj_feet = [
    (20, '''Getaway boots (30,000gp)'''),
    (35, '''Horseshoes of crushing blows +3 (36,000gp)'''),
    (55, '''Horseshoes of glory (39,600gp)'''),
    (75, '''Burglar boots, major (46,000gp)'''),
    (100, '''Boots of teleportation (49,000gp)'''),
    ]
gmaj_feet = [
    (40, '''Slippers of the triton (56,000gp)'''),
    (70, '''Horseshoes of crushing blows +4 (64,000gp)'''),
    (100, '''Horseshoes of crushing blows +5 (100,000gp)'''),
    ]

lmin_hand = [
    (13, '''Assisting gloves (180gp)'''),
    (22, '''Claws of the ice bear (1,300gp)'''),
    (34, '''Gloves of reconnaissance (2,000gp)'''),
    (46, '''Glowing glove (2,000gp)'''),
    (58, '''Apprentice's cheating gloves (2,200gp)'''),
    (70, '''Challenger's gloves (2,200gp)'''),
    (80, '''Gloves of larceny (2,500gp)'''),
    (90, '''Healer's gloves (2,500gp)'''),
    (100, '''Engineer's workgloves (3,000gp)'''),
    ]
gmin_hand = [
    (12, '''Gauntlets of the skilled maneuver (4,000gp)'''),
    (21, '''Ghostvision gloves (4,000gp)'''),
    (33, '''Gloves of arrow snaring (4,000gp)'''),
    (43, '''Trapspringer's gloves (4,000gp)'''),
    (55, '''Gloves of arcane striking (5,000gp)'''),
    (65, '''Poisoner's gloves (5,000gp)'''),
    (75, '''Magnetist's gloves (6,000gp)'''),
    (100, '''(6,250gp)'''),
    ]
lmed_hand = [
    (2, '''Deliquescent gloves (8,000gp)'''),
    (5, '''Form-fixing gauntlets (8,000gp)'''),
    (8, '''Iron cobra gauntlet (8,000gp)'''),
    (16, '''Shadow falconer's glove (8,000gp)'''),
    (20, '''Spellstrike gloves (8,000gp)'''),
    (28, '''Glyphbane gloves (9,000gp)'''),
    (40, '''Glove of storing (10,000gp)'''),
    (46, '''Gloves of shaping (10,000gp)'''),
    (54, '''Pliant gloves (10,000gp)'''),
    (76, '''Gauntlet of rust (11,500gp)'''),
    (100, '''Gloves of dueling (15,000gp)'''),
    ]
gmed_hand = [
    (30, '''Vampiric gloves (18,000gp)'''),
    (65, '''Giant fist gauntlets (20,000gp)'''),
    (100, '''Gloves of the shortened path (27,000gp)'''),
    ]
lmaj_hand = [
    (40, '''Gloves of the commanding conjurer (30,000gp)'''),
    (100, '''Gauntlet of rust, greater (34,500gp)'''),
    ]
gmaj_hand = [
    (60, '''Talons of Leng (67,000gp)'''),
    (100, '''Gauntlets of the weaponmaster (110,000gp)'''),
    ]

lmin_head = [
    (10, '''Mask of stony demeanor (500gp)'''),
    (22, '''Cap of human guise (800gp)'''),
    (36, '''Cap of light (900gp)'''),
    (56, '''Hat of disguise (1,800gp)'''),
    (71, '''Buffering cap (2,000gp)'''),
    (85, '''Miser's mask (3,000gp)'''),
    (100, '''Stalker's mask (3,500gp)'''),
    ]
gmin_head = [
    (12, '''Circlet of persuasion (4,500gp)'''),
    (21, '''Grappler's mask (5,000gp)'''),
    (31, '''Helm of fearsome mien (5,000gp)'''),
    (40, '''Jingasa of the fortunate soldier (5,000gp)'''),
    (54, '''Helm of comprehend languages and read magic (5,200gp)'''),
    (67, '''Crown of swords (6,000gp)'''),
    (87, '''Crown of blasting, minor (6,480gp)'''),
    (100, '''Mask of the krenshar (7,200gp)'''),
    ]
lmed_head = [
    (16, '''Helm of the mammoth lord (8,500gp)'''),
    (30, '''Veil of fleeting glances (9,000gp)'''),
    (46, '''Mask of a thousand tomes (10,000gp)'''),
    (63, '''Medusa mask (10,000gp)'''),
    (80, '''Cap of the free thinker (12,000gp)'''),
    (100, '''Halo of inner calm (16,000gp)'''),
    ]
gmed_head = [
    (6, '''Cat's eye crown (18,000gp)'''),
    (12, '''Maw of the wyrm (18,000gp)'''),
    (19, '''Mitre of the hierophant (18,000gp)'''),
    (27, '''Magician's hat (20,000gp)'''),
    (34, '''Circlet of mindsight (22,000gp)'''),
    (42, '''Mask of the skull (22,000gp)'''),
    (50, '''Howling helm (22,600gp)'''),
    (62, '''Crown of blasting, major (23,760gp)'''),
    (72, '''Helm of underwater action (24,000gp)'''),
    (79, '''Crown of conquest (24,600gp)'''),
    (85, '''Batrachian helm (26,000gp)'''),
    (94, '''Helm of telepathy (27,000gp)'''),
    (100, '''Plague mask (27,000gp)'''),
    ]
lmaj_head = [
    (14, '''Iron circlet of guarded souls (30,000gp)'''),
    (29, '''Laurel of command (30,000gp)'''),
    (45, '''Mask of giants, lesser (30,000gp)'''),
    (61, '''Steel-mind cap (33,600gp)'''),
    (78, '''Stormlord's helm (35,000gp)'''),
    (100, '''Helm of brilliance, lesser (36,000gp)'''),
    ]
gmaj_head = [
    (14, '''Judge's wig (59,200gp)'''),
    (39, '''Helm of teleportation (73,500gp)'''),
    (55, '''Halo of menace (84,000gp)'''),
    (68, '''Mask of giants, greater (90,000gp)'''),
    (83, '''Helm of brilliance (125,000gp)'''),
    (92, '''Helm of electric radiance (125,000gp)'''),
    (100, '''Crown of heaven (150,000gp)'''),
    ]

lmin_headband = [
    (60, '''Phylactery of faithfulness (1,000gp)'''),
    (100, '''Dead man's headband (3,600gp)'''),
    ]
gmin_headband = [
    (9, '''Headband of alluring charisma +2 (4,000gp)'''),
    (18, '''Headband of inspired wisdom +2 (4,000gp)'''),
    (27, '''Headband of vast intelligence +2 (4,000gp)'''),
    (33, '''Headband of aerial agility +2 (4,500gp)'''),
    (39, '''Shifter's headband +2 (4,500gp)'''),
    (45, '''Headband of ponderous recollection (5,100gp)'''),
    (51, '''Headband of ki focus (5,400gp)'''),
    (58, '''Headband of unshakeable resolve (5,600gp)'''),
    (66, '''Hollywreath band (5,700gp)'''),
    (74, '''Headband of deathless devotion (6,400gp)'''),
    (82, '''Phylactery of the shepherd (7,000gp)'''),
    (91, '''Headband of intuition (7,000gp)'''),
    (100, '''Headband of fortune's favor (7,700gp)'''),
    ]
lmed_headband = [
    (6, '''Headband of havoc (8,000gp)'''),
    (12, '''Serpent's band (9,000gp)'''),
    (20, '''Headband of mental prowess +2 (10,000gp)'''),
    (26, '''Hunter's band (11,000gp)'''),
    (34, '''Phylactery of negative channeling (11,000gp)'''),
    (42, '''Phylactery of positive channeling (11,000gp)'''),
    (48, '''Veiled eye (12,000gp)'''),
    (54, '''Band of the stalwart warrior (14,000gp)'''),
    (60, '''Headband of ninjitsu (15,000gp)'''),
    (68, '''Headband of alluring charisma +4 (16,000gp)'''),
    (76, '''Headband of inspired wisdom +4 (16,000gp)'''),
    (85, '''Headband of mental superiority +2 (16,000gp)'''),
    (93, '''Headband of vast intelligence +4 (16,000gp)'''),
    (100, '''Shifter's headband +4 (17,500gp)'''),
    ]
gmed_headband = [
    (30, '''Headband of arcane energy (20,000gp)'''),
    (70, '''Headband of counterspelling (20,000gp)'''),
    (100, '''Headband of knucklebones (27,500gp)'''),
    ]
lmaj_headband = [
    (9, '''Soulbound eye (30,000gp)'''),
    (19, '''Winter wolf headband (32,000gp)'''),
    (32, '''Headband of alluring charisma +6 (36,000gp)'''),
    (45, '''Headband of inspired wisdom +6 (36,000gp)'''),
    (58, '''Headband of vast intelligence +6 (36,000gp)'''),
    (66, '''Shifter's headband +6 (39,000gp)'''),
    (81, '''Headband of mental prowess +4 (40,000gp)'''),
    (90, '''Headband of seduction (40,000gp)'''),
    (100, '''Headband of aerial agility +4 (42,000gp)'''),
    ]
gmaj_headband = [
    (20, '''Headband of mental resilience (64,000gp)'''),
    (50, '''Headband of mental superiority +4 (64,000gp)'''),
    (65, '''Headband of aerial agility +6 (81,000gp)'''),
    (85, '''Headband of metal prowess +6 (90,000gp)'''),
    (100, '''Headband of mental superiority +6 (144,000gp)'''),
    ]

lmin_neck = [
    (10, '''Hand of the mage (900gp)'''),
    (18, '''Aegis of recovery (1,500gp)'''),
    (25, '''Amulet of bullet protection +1 (1,500gp)'''),
    (37, '''Brooch of shielding (1,500gp)'''),
    (49, '''Necklace of fireballs (type I) (1,650gp)'''),
    (63, '''Amulet of natural armor +1 (2,000gp)'''),
    (72, '''Golembane scarab (2,500gp)'''),
    (82, '''Necklace of fireballs (type II) (2,700gp)'''),
    (89, '''Swarmbane clasp (3,000gp)'''),
    (95, '''Mind sentinel medallion (3,500gp)'''),
    (100, '''Mummer's ruff (3,500gp)'''),
    ]
gmin_neck = [
    (8, '''Amulet of elemental strife (4,000gp)'''),
    (15, '''Righteous fist amulet (4,000gp)'''),
    (26, '''Necklace of fireballs (type III) (4,350gp)'''),
    (36, '''Amulet of mighty fists +1 (5,000gp)'''),
    (47, '''Necklace of fireballs (type IV) (5,400gp)'''),
    (55, '''Stormlure (5,400gp)'''),
    (66, '''Necklace of fireballs (type V) (5,850gp)'''),
    (73, '''Amulet of bullet protection +2 (6,000gp)'''),
    (81, '''Feychild necklace (6,000gp)'''),
    (89, '''Carcanet of detention (7,200gp)'''),
    (100, '''Periapt of health (7,500gp)'''),
    ]
lmed_neck = [
    (8, '''Amulet of natural armor +2 (8,000gp)'''),
    (12, '''Amulet of proof against petrification (8,000gp)'''),
    (15, '''Everwake amulet (8,000gp)'''),
    (18, '''Gravewatch pendant (8,000gp)'''),
    (23, '''Hand of glory (8,000gp)'''),
    (26, '''Torc of lionheart fury (8,000gp)'''),
    (33, '''Necklace of fireballs (type VI) (8,100gp)'''),
    (40, '''Necklace of fireballs (type VII) (8,700gp)'''),
    (43, '''Amulet of hidden strength (9,000gp)'''),
    (47, '''Necklace of adaptation (9,000gp)'''),
    (51, '''Amulet of spell cunning (10,000gp)'''),
    (54, '''Collar of the true companion (10,000gp)'''),
    (58, '''Frost fist amulet (10,000gp)'''),
    (63, '''Crystal of healing hands (12,000gp)'''),
    (66, '''Guardian gorget (12,000gp)'''),
    (73, '''Medallion of thoughts (12,000gp)'''),
    (77, '''Periapt of protection from curses (12,000gp)'''),
    (81, '''Forge fist amulet (13,000gp)'''),
    (85, '''Amulet of bullet protection +3 (13,500gp)'''),
    (92, '''Periapt of wound closure (15,000gp)'''),
    (95, '''Necklace of ki serenity (16,000gp)'''),
    (98, '''Brooch of amber sparks (16,800gp)'''),
    (100, '''Symbol of sanguine protection (17,500gp)'''),
    ]
gmed_neck = [
    (15, '''Amulet of natural armor +3 (18,000gp)'''),
    (24, '''Ampoule of false blood (20,000gp)'''),
    (35, '''Amulet of magecraft (20,000gp)'''),
    (50, '''Amulet of mighty fists +2 (20,000gp)'''),
    (62, '''Dragonfoe amulet (20,000gp)'''),
    (67, '''Amulet of spell mastery (22,000gp)'''),
    (72, '''Amulet of bullet protection +4 (24,000gp)'''),
    (85, '''Hand of stone (27,000gp)'''),
    (100, '''Periapt of proof against poison (27,000gp)'''),
    ]
lmaj_neck = [
    (18, '''Amulet of natural armor +4 (32,000gp)'''),
    (35, '''Amulet of proof against detection and location (35,000gp)'''),
    (49, '''Amulet of bullet protection +5 (37,500gp)'''),
    (67, '''Scarab of protection (38,000gp)'''),
    (82, '''Necklace of netted stars (42,000gp)'''),
    (100, '''Amulet of mighty fists +3 (45,000gp)'''),
    ]
gmaj_neck = [
    (35, '''Amulet of natural armor +5 (50,000gp)'''),
    (60, '''Amulet of mighty fists +4 (80,000gp)'''),
    (85, '''Amulet of the planes (120,000gp)'''),
    (100, '''Amulet of mighty fists +5 (125,000gp)'''),
    ]

lmin_shoulder = [
    (6, '''Catching cape (200gp)'''),
    (10, '''Cloak of human guise (900gp)'''),
    (30, '''Cloak of resistance +1 (1,000gp)'''),
    (36, '''Muleback cords (1,000gp)'''),
    (38, '''Shawl of life-keeping (1,000gp)'''),
    (44, '''Shield cloak (1,000gp)'''),
    (50, '''Quickchange cloak (1,500gp)'''),
    (56, '''Cowardly crouching cloak (1,800gp)'''),
    (74, '''Cloak of elvenkind (2,500gp)'''),
    (80, '''Cloak of the hedge wizard (2,500gp)'''),
    (85, '''Cloak of fiery vanishing (2,600gp)'''),
    (94, '''Cloak of fangs (2,800gp)'''),
    (97, '''Pauldrons of the serpent (3,000gp)'''),
    (100, '''Stonemist cloak (3,500gp)'''),
    ]
gmin_shoulder = [
    (26, '''Cloak of resistance +2 (4,000gp)'''),
    (38, '''Cloak of the scuttling rat (6,000gp)'''),
    (39, '''Seafoam shawl (6,000gp)'''),
    (52, '''Treeform cloak (6,000gp)'''),
    (74, '''Eagle cape (7,000gp)'''),
    (94, '''Cloak of the manta ray (7,200gp)'''),
    (100, '''Hunter's cloak (7,500gp)'''),
    ]
lmed_shoulder = [
    (20, '''Cloak of resistance +3 (9,000gp)'''),
    (22, '''Cloak of the duskwalker (10,000gp)'''),
    (25, '''Cocoon cloak (10,000gp)'''),
    (27, '''Pauldrons of the bull (10,000gp)'''),
    (32, '''Stone cloak, minor (10,000gp)'''),
    (40, '''Cape of the mountebank (10,800gp)'''),
    (45, '''Pauldrons of the watchful lion (10,800gp)'''),
    (52, '''Lion cloak (12,000gp)'''),
    (54, '''Mantle of spores (13,400gp)'''),
    (59, '''Cape of effulgent escape (14,000gp)'''),
    (69, '''Cloak of arachnida (14,000gp)'''),
    (72, '''Gunfighter's poncho (14,000gp)'''),
    (74, '''Tentacle cloak (14,000gp)'''),
    (76, '''Demonspike pauldrons (14,350gp)'''),
    (78, '''Comfort's cloak (15,600gp)'''),
    (88, '''Cloak of resistance +4 (16,000gp)'''),
    (91, '''Shawl of the crone (16,000gp)'''),
    (100, '''Prestidigitator's cloak (17,200gp)'''),
    ]
gmed_shoulder = [
    (12, '''Stole of justice (18,000gp)'''),
    (24, '''Jellyfish cape (19,200gp)'''),
    (32, '''Cloak of the diplomat (20,000gp)'''),
    (44, '''Slashing cloak (20,000gp)'''),
    (56, '''Stone cloak, major (20,000gp)'''),
    (68, '''Cloak of displacement, minor (24,000gp)'''),
    (88, '''Cloak of resistance +5 (25,000gp)'''),
    (100, '''Cloak of the bat (26,000gp)'''),
    ]
lmaj_shoulder = [
    (40, '''Highwayman's cape (32,500gp)'''),
    (60, '''Juggernaut's pauldrons (40,000gp)'''),
    (100, '''Charlatan's cape (45,000gp)'''),
    ]
gmaj_shoulder = [
    (15, '''Cloak of displacement, major (50,000gp)'''),
    (35, '''Wings of flying (54,000gp)'''),
    (55, '''Cloak of etherealness (55,000gp)'''),
    (80, '''Wings of the gargoyle (72,000gp)'''),
    (100, '''Wyvern cloak (78,600gp)'''),
    ]

lmin_wrist = [
    (10, '''Sleeves of many garments (200gp)'''),
    (20, '''Armbands of the brawler (500gp)'''),
    (48, '''Bracers of armor +1 (1,000gp)'''),
    (63, '''Burglar's bracers (1,000gp)'''),
    (91, '''Bracers of steadiness (2,000gp)'''),
    (96, '''Manacles of cooperation (2,000gp)'''),
    (100, '''Shackles of compliance (3,280gp)'''),
    ]
gmin_wrist = [
    (27, '''Bracers of armor +2 (4,000gp)'''),
    (28, '''Bracers of falcon's aim (4,000gp)'''),
    (38, '''Inquisitor's bastion vambraces (4,000gp)'''),
    (65, '''Bracers of archery, lesser (5,000gp)'''),
    (68, '''Spellguard bracers (5,000gp)'''),
    (71, '''Bonebreaker gauntlets (6,000gp)'''),
    (81, '''Vambraces of defense (6,000gp)'''),
    (98, '''Verdant vine (6,000gp)'''),
    (99, '''Longarm bracers (7,200gp)'''),
    (100, '''Bracers of the glib entertainer (7,900gp)'''),
    ]
lmed_wrist = [
    (4, '''Charm bracelet (8,000gp)'''),
    (8, '''Duelist's vambraces (8,000gp)'''),
    (13, '''Merciful vambraces (8,000gp)'''),
    (18, '''Vambraces of the tactician (8,000gp)'''),
    (43, '''Bracers of armor +3 (9,000gp)'''),
    (53, '''Seducer's bane (9,900gp)'''),
    (58, '''Bracers of the avenging knight (11,500gp)'''),
    (63, '''Arrowmaster's bracers (13,900gp)'''),
    (73, '''Vambraces of the genie (efreeti) (14,400gp)'''),
    (78, '''Bracelet of bargaining (14,500gp)'''),
    (82, '''Bracelet of mercy (15,000gp)'''),
    (86, '''Bracers of the merciful knight (15,600gp)'''),
    (90, '''Bracelet of second chances (15,750gp)'''),
    (99, '''Bracers of armor +4 (16,000gp)'''),
    (100, '''Shackles of durance vile (16,200gp)'''),
    ]
gmed_wrist = [
    (10, '''Vambraces of the genie (djinni) (18,900gp)'''),
    (20, '''Vambraces of the genie (marid) (18,900gp)'''),
    (30, '''Vambraces of the genie (shaitan) (18,900gp)'''),
    (50, '''Bracelet of friends (19,000gp)'''),
    (70, '''Bracers of archery, greater (25,000gp)'''),
    (90, '''Bracers of armor +5 (25,000gp)'''),
    (100, '''Bracers of sworn vengeance (25,000gp)'''),
    ]
lmaj_wrist = [
    (30, '''Dimensional shackles (28,000gp)'''),
    (45, '''Gauntlets of skill at arms (30,000gp)'''),
    (100, '''Bracers of armor +6 (36,000gp)'''),
    ]
gmaj_wrist = [
    (60, '''Bracers of armor +7 (49,000gp)'''),
    (100, '''Bracers of armor +8 (64,000gp)'''),
    ]

emin_slotless = [
    (1, '''Feather token (anchor) (50gp)'''),
    (2, '''Universal solvent (50gp)'''),
    (4, '''Ioun torch (75gp)'''),
    (5, '''Stubborn nail (100gp)'''),
    (6, '''War paint of the terrible visage (100gp)'''),
    (7, '''Elixir of love (150gp)'''),
    (8, '''Unguent of timelessness (150gp)'''),
    (9, '''Feather token (fan) (200gp)'''),
    (10, '''Formula alembic (200gp)'''),
    (11, '''Hybridization funnel (200gp)'''),
    (12, '''Soul soap (200gp)'''),
    (13, '''Dust of tracelessness (250gp)'''),
    (16, '''Elixir of hiding (250gp)'''),
    (19, '''Elixir of swimming (250gp)'''),
    (22, '''Elixir of tumbling (250gp)'''),
    (25, '''Elixir of vision (250gp)'''),
    (27, '''Nightdrops (250gp)'''),
    (28, '''Oil of silence (250gp)'''),
    (31, '''Silversheen (250gp)'''),
    (32, '''Traveler's any-tool (250gp)'''),
    (34, '''Bottle of messages (300gp)'''),
    (36, '''Feather token (bird) (300gp)'''),
    (37, '''Origami swarm (300gp)'''),
    (38, '''Alluring golden apple (400gp)'''),
    (39, '''Feather token (tree) (400gp)'''),
    (40, '''Key of lock jamming (400gp)'''),
    (42, '''Feather token (swan boat) (450gp)'''),
    (43, '''Animated portrait (500gp)'''),
    (44, '''Bottled misfortune (500gp)'''),
    (46, '''Elixir of truth (500gp)'''),
    (48, '''Feather token (whip) (500gp)'''),
    (51, '''Scabbard of honing (500gp)'''),
    (53, '''Seer's tea (550gp)'''),
    (57, '''Abjurant salt (600gp)'''),
    (61, '''Arrow magnet (600gp)'''),
    (63, '''Dust of darkness (600gp)'''),
    (69, '''Campfire bead (720gp)'''),
    (72, '''Archon's torch (750gp)'''),
    (75, '''Book of extended summoning (lesser) (750gp)'''),
    (79, '''Iron rope (750gp)'''),
    (83, '''Snapleaf (750gp)'''),
    (86, '''Bottled yeti fur (800gp)'''),
    (89, '''Defoliant polish (800gp)'''),
    (92, '''Dust of emulation (800gp)'''),
    (97, '''Steadfast gut-stone (800gp)'''),
    (100, '''Dust of dryness (850gp)'''),
    ]
lmin_slotless = [
    (3, '''Roll on the Least Minor table'''),
    (4, '''Anatomy doll (1,000gp)'''),
    (5, '''Bead of newt prevention (1,000gp)'''),
    (6, '''Beast-bond brand (1,000gp)'''),
    (7, '''Bookplate of recall (1,000gp)'''),
    (9, '''Boro bead (1st) (1,000gp)'''),
    (10, '''Concealing pocket (1,000gp)'''),
    (11, '''Dowsing syrup (1,000gp)'''),
    (12, '''Incense of transcendence (1,000gp)'''),
    (14, '''Page of spell knowledge (1st) (1,000gp)'''),
    (17, '''Pearl of Power (1st) (1,000gp)'''),
    (18, '''Preserving flask (1st) (1,000gp)'''),
    (20, '''Pyxes of redirected focus (1,000gp)'''),
    (22, '''Salve of slipperiness (1,000gp)'''),
    (23, '''Wasp nest of swarming (1,000gp)'''),
    (26, '''Elixir of fire breath (1,100gp)'''),
    (27, '''Grave salt (1,100gp)'''),
    (29, '''Pipes of the sewers (1,150gp)'''),
    (31, '''Dust of illusion (1,200gp)'''),
    (33, '''Goblin skull bomb (1,200gp)'''),
    (35, '''Elixir of dragon breath (1,400gp)'''),
    (36, '''Bookmark of deception (1,500gp)'''),
    (37, '''Word bottle (1,500gp)'''),
    (38, '''Dust of acid consumption (1,600gp)'''),
    (40, '''Dust of appearance (1,800gp)'''),
    (42, '''Efficient quiver (1,800gp)'''),
    (43, '''Pipes of sounding (1,800gp)'''),
    (44, '''Scabbard of vigor (1,800gp)'''),
    (45, '''Agile alpenstock (2,000gp)'''),
    (46, '''Blood reservoir of physical prowess (2,000gp)'''),
    (47, '''Clamor box (2,000gp)'''),
    (48, '''Dry load powder horn (2,000gp)'''),
    (49, '''Goblin fire drum (normal) (2,000gp)'''),
    (51, '''Handy haversack (2,000gp)'''),
    (53, '''Horn of fog (2,000gp)'''),
    (54, '''Iron spike of safe passage (2,000gp)'''),
    (55, '''Knight's pennon (honor) (2,200gp)'''),
    (59, '''Volatile vaporizer (1st) (2,200gp)'''),
    (62, '''Elemental gem (2,250gp)'''),
    (64, '''Flying ointment (2,250gp)'''),
    (65, '''Sovereign glue (2,400gp)'''),
    (66, '''Apple of eternal sleep (2,500gp)'''),
    (68, '''Bag of holding (type I) (2,500gp)'''),
    (69, '''Candle of truth (2,500gp)'''),
    (70, '''Hexing doll (2,500gp)'''),
    (72, '''Stone of alarm (2,700gp)'''),
    (73, '''Book of extended summoning (standard) (2,750gp)'''),
    (77, '''Bead of force (3,000gp)'''),
    (78, '''Cauldron of brewing (3,000gp)'''),
    (80, '''Chime of opening (3,000gp)'''),
    (81, '''Philter of love (3,000gp)'''),
    (86, '''Rope of climbing (3,000gp)'''),
    (88, '''Volatile vaporizer (2nd) (3,000gp)'''),
    (89, '''Shroud of disintegration (3,300gp)'''),
    (92, '''Bag of tricks (gray) (3,400gp)'''),
    (95, '''Dust of disappearance (3,500gp)'''),
    (96, '''Dust of weighty burdens (3,600gp)'''),
    (97, '''Noble's vigilant pillbox (3,600gp)'''),
    (99, '''Figurine of wondrous power (silver raven) (3,800gp)'''),
    (100, '''Volatile vaporizer (3rd) (3,800gp)'''),
    ]
gmin_slotless = [
    (1, '''Boro bead (2nd) (4,000gp)'''),
    (2, '''Cautionary creance (4,000gp)'''),
    (3, '''Escape ladder (4,000gp)'''),
    (4, '''Far-reaching sight (4,000gp)'''),
    (6, '''Ioun stone (clear spindle) (4,000gp)'''),
    (7, '''Marvelous pigments (4,000gp)'''),
    (15, '''Page of spell knowledge (2nd) (4,000gp)'''),
    (25, '''Pearl of Power (2nd) (4,000gp)'''),
    (26, '''Preserving flask (2nd) (4,000gp)'''),
    (27, '''Restorative ointment (4,000gp)'''),
    (30, '''Stone salve (4,000gp)'''),
    (31, '''Wind-caller compass (4,400gp)'''),
    (32, '''Goblin fire drum (greater) (4,500gp)'''),
    (33, '''Knight's pennon (battle) (4,500gp)'''),
    (34, '''Knight's pennon (parley) (4,500gp)'''),
    (35, '''Void dust (4,500gp)'''),
    (36, '''Incense of meditation (4,900gp)'''),
    (37, '''Admixture vial (5,000gp)'''),
    (51, '''Bag of holding (type II) (5,000gp)'''),
    (52, '''Bone razor (5,000gp)'''),
    (53, '''Horn of the huntmaster (5,000gp)'''),
    (54, '''Insistent doorknocker (5,000gp)'''),
    (56, '''Ioun stone (dusty rose prism) (5,000gp)'''),
    (57, '''Mallet of building (5,000gp)'''),
    (58, '''Polymorphic pouch (5,000gp)'''),
    (59, '''Scabbard of stanching (5,000gp)'''),
    (60, '''School of eyes (5,000gp)'''),
    (61, '''Sheath of bladestealth (5,000gp)'''),
    (62, '''Stone of alliance (5,000gp)'''),
    (63, '''Summoning shackle (5,000gp)'''),
    (64, '''Eversmoking bottle (5,400gp)'''),
    (65, '''Sustaining spoon (5,400gp)'''),
    (66, '''Wind fan (5,500gp)'''),
    (67, '''Grim lantern (5,800gp)'''),
    (68, '''Coin of the untrodden road (6,000gp)'''),
    (69, '''Horn of battle clarity (6,000gp)'''),
    (70, '''Life link badge (6,000gp)'''),
    (71, '''Martyr's tear (6,000gp)'''),
    (72, '''Pipes of haunting (6,000gp)'''),
    (73, '''Rope of knots (6,000gp)'''),
    (74, '''Singing bell of striking (6,000gp)'''),
    (75, '''Stone familiar (6,000gp)'''),
    (76, '''Book of extended summoning (greater) (6,126gp)'''),
    (77, '''Dragonbone divination sticks (6,400gp)'''),
    (79, '''Horn of goodness/evil (6,500gp)'''),
    (79, '''Naga-scale bindi (6,600gp)'''),
    (80, '''Bottle of shadows (7,000gp)'''),
    (81, '''Cape of bravado (7,000gp)'''),
    (83, '''Instant bridge (7,000gp)'''),
    (84, '''Mirror of guarding reflections (7,000gp)'''),
    (85, '''Folding boat (7,200gp)'''),
    (87, '''Bottle of air (7,250gp)'''),
    (94, '''Bag of holding (type III) (7,400gp)'''),
    (95, '''Balm of impish grace (7,500gp)'''),
    (96, '''Candle of clean air (7,500gp)'''),
    (97, '''Harp of charming (7,500gp)'''),
    (100, '''Manual of war (7,500gp)'''),
    ]
lmed_slotless = [
    (1, '''Chalice of poison weeping (8,000gp)'''),
    (2, '''Exorcist's aspergillum (8,000gp)'''),
    (3, '''Golem manual (flesh) (8,000gp)'''),
    (4, '''Harp of shattering (8,000gp)'''),
    (5, '''Insignia of valor (8,000gp)'''),
    (6, '''Ioun stone (deep red sphere) (8,000gp)'''),
    (7, '''Ioun stone (incandescent blue sphere) (8,000gp)'''),
    (8, '''Ioun stone (pale blue rhomboid) (8,000gp)'''),
    (9, '''Ioun stone (pink and green sphere) (8,000gp)'''),
    (10, '''Ioun stone (pink rhomboid) (8,000gp)'''),
    (11, '''Ioun stone (scarlet and blue sphere) (8,000gp)'''),
    (12, '''Needles of fleshgraving (8,000gp)'''),
    (13, '''Restless lockpicks (8,000gp)'''),
    (14, '''Werewhistle (8,000gp)'''),
    (16, '''Deck of illusions (8,100gp)'''),
    (17, '''Candle of invocation (8,400gp)'''),
    (19, '''Bag of tricks (rust) (8,500gp)'''),
    (20, '''Boro bead (3rd) (9,000gp)'''),
    (21, '''Decanter of endless water (9,000gp)'''),
    (22, '''Loathsome mirror (9,000gp)'''),
    (25, '''Page of spell knowledge (3rd) (9,000gp)'''),
    (31, '''Pearl of Power (3rd) (9,000gp)'''),
    (32, '''Preserving flask (3rd) (9,000gp)'''),
    (33, '''Figurine of wondrous power (serpentine owl) (9,100gp)'''),
    (34, '''Strand of prayer beads (lesser) (9,600gp)'''),
    (38, '''Bag of holding (type IV) (10,000gp)'''),
    (39, '''Boundary chalk (10,000gp)'''),
    (40, '''Chime of resounding silence (10,000gp)'''),
    (41, '''Construct channel brick (10,000gp)'''),
    (42, '''Doomharp (10,000gp)'''),
    (43, '''Drum of advance and retreat (10,000gp)'''),
    (44, '''Embalming thread (10,000gp)'''),
    (45, '''Eye of the void (10,000gp)'''),
    (46, '''Figurine of wondrous power (bronze griffon) (10,000gp)'''),
    (47, '''Figurine of wondrous power (ebony fly) (10,000gp)'''),
    (48, '''Figurine of wondrous power (slate spider) (10,000gp)'''),
    (49, '''Hourglass of last chances (10,000gp)'''),
    (51, '''Ioun stone (dark blue rhomboid) (10,000gp)'''),
    (52, '''Ki mat (10,000gp)'''),
    (53, '''Lord's banner (swiftness) (10,000gp)'''),
    (54, '''Malleable symbol (10,000gp)'''),
    (55, '''Migrus locker (10,000gp)'''),
    (56, '''Ornament of healing light (10,000gp)'''),
    (57, '''Prayer wheel of ethical strength (10,000gp)'''),
    (58, '''Stone horse (courser) (10,000gp)'''),
    (59, '''Summon-slave crystal (10,000gp)'''),
    (60, '''Treasurer's seal (10,000gp)'''),
    (61, '''Black soul shard (12,000gp)'''),
    (62, '''Golem manual (clay) (12,000gp)'''),
    (63, '''Horsemaster's saddle (12,000gp)'''),
    (64, '''Pipes of dissolution (12,000gp)'''),
    (65, '''Pipes of pain (12,000gp)'''),
    (66, '''Seeker's sight (12,000gp)'''),
    (67, '''Blessed book (12,500gp)'''),
    (68, '''Waters of transfiguration (12,500gp)'''),
    (69, '''Gem of brightness (13,000gp)'''),
    (70, '''Harp of contagion (13,000gp)'''),
    (71, '''Lyre of building (13,000gp)'''),
    (72, '''Void pennant (14,000gp)'''),
    (73, '''Stone horse (destrier) (14,800gp)'''),
    (74, '''Book of the loremaster (15,000gp)'''),
    (75, '''Cauldron of plenty (15,000gp)'''),
    (76, '''Horn of judgment (15,000gp)'''),
    (77, '''Horn of the tritons (15,000gp)'''),
    (78, '''Pearl of the sirines (15,300gp)'''),
    (79, '''Figurine of wondrous power (onyx dog) (15,500gp)'''),
    (81, '''Bag of tricks (tan) (16,000gp)'''),
    (82, '''Boro bead (4th) (16,000gp)'''),
    (83, '''Page of spell knowledge (4th) (16,000gp)'''),
    (87, '''Pearl of Power (4th) (16,000gp)'''),
    (88, '''Preserving flask (4th) (16,000gp)'''),
    (91, '''Scabbard of keen edges (16,000gp)'''),
    (93, '''Figurine of wondrous power (golden lions) (16,500gp)'''),
    (95, '''Chime of interruption (16,800gp)'''),
    (99, '''Broom of flying (17,000gp)'''),
    (100, '''Figurine of wondrous power (marble elephant) (17,000gp)'''),
    ]
gmed_slotless = [
    (3, '''Ioun stone (iridescent spindle) (18,000gp)'''),
    (4, '''Orb of foul Abaddon (18,000gp)'''),
    (8, '''Carpet of flying (5 ft. by 5 ft.) (20,000gp)'''),
    (9, '''Horn of antagonism (20,000gp)'''),
    (13, '''Horn of blasting (20,000gp)'''),
    (17, '''Ioun stone (pale lavender ellipsoid) (20,000gp)'''),
    (21, '''Ioun stone (pearly white spindle) (20,000gp)'''),
    (24, '''Master's perfect golden bell (20,000gp)'''),
    (27, '''Necromancer's athame (20,000gp)'''),
    (31, '''Portable hole (20,000gp)'''),
    (35, '''Stone of good luck (20,000gp)'''),
    (37, '''Figurine of wondrous power (ivory goats) (21,000gp)'''),
    (40, '''Rope of entanglement (21,000gp)'''),
    (42, '''Golem manual (stone) (22,000gp)'''),
    (43, '''Orb of golden heaven (22,000gp)'''),
    (45, '''Mattock of the titans (23,348gp)'''),
    (48, '''Drinking horn of bottomless valor (24,000gp)'''),
    (51, '''Boro bead (5th) (25,000gp)'''),
    (53, '''Chaos emerald (25,000gp)'''),
    (57, '''Page of spell knowledge (5th) (25,000gp)'''),
    (64, '''Pearl of Power (5th) (25,000gp)'''),
    (67, '''Preserving flask (5th) (25,000gp)'''),
    (69, '''Maul of the titans (25,305gp)'''),
    (73, '''Iron bands of binding (26,000gp)'''),
    (76, '''Cube of frost resistance (27,000gp)'''),
    (80, '''Manual of bodily health +1 (27,500gp)'''),
    (84, '''Manual of gainful exercise +1 (27,500gp)'''),
    (88, '''Manual of quickness of action +1 (27,500gp)'''),
    (92, '''Tome of clear thought +1 (27,500gp)'''),
    (96, '''Tome of leadership and influence +1 (27,500gp)'''),
    (100, '''Tome of understanding +1 (27,500gp)'''),
    ]
lmaj_slotless = [
    (4, '''Figurine of wondrous power (obsidian steed) (28,500gp)'''),
    (7, '''Cauldron of the dead (30,000gp)'''),
    (11, '''Drums of panic (30,000gp)'''),
    (15, '''Ioun stone (orange prism) (30,000gp)'''),
    (19, '''Ioun stone (pale green prism) (30,000gp)'''),
    (23, '''Lantern of revealing (30,000gp)'''),
    (27, '''Racing broom of flying (30,000gp)'''),
    (31, '''Cauldron of resurrection (33,000gp)'''),
    (36, '''Carpet of flying (5 ft. by 10 ft.) (35,000gp)'''),
    (38, '''Golem manual (iron) (35,000gp)'''),
    (40, '''Boro bead (6th) (36,000gp)'''),
    (44, '''Ioun stone (vibrant purple prism) (36,000gp)'''),
    (48, '''Orb of utter chaos (36,000gp)'''),
    (50, '''Page of spell knowledge (6th) (36,000gp)'''),
    (58, '''Pearl of Power (6th) (36,000gp)'''),
    (60, '''Preserving flask (6th) (36,000gp)'''),
    (64, '''Cauldron of flying (40,000gp)'''),
    (66, '''Enmity fetish (40,000gp)'''),
    (69, '''Ioun stone (lavender and green ellipsoid) (40,000gp)'''),
    (73, '''Ring gates (40,000gp)'''),
    (77, '''Cauldron of seeing (42,000gp)'''),
    (81, '''Crystal ball (42,000gp)'''),
    (83, '''Golem manual (stone guardian) (44,000gp)'''),
    (87, '''Drums of haste (45,000gp)'''),
    (91, '''Strand of prayer beads (standard) (45,800gp)'''),
    (94, '''Orb of storms (48,000gp)'''),
    (96, '''Page of spell knowledge (7th) (49,000gp)'''),
    (100, '''Pearl of Power (7th) (49,000gp)'''),
    ]
gmaj_slotless = [
    (3, '''Crystal ball with see invisibility (50,000gp)'''),
    (5, '''Horn of Valhalla (50,000gp)'''),
    (8, '''Crystal ball with detect thoughts (51,000gp)'''),
    (9, '''Last leaves of the autumn dryad (52,000gp)'''),
    (11, '''Instant fortress (55,000gp)'''),
    (15, '''Manual of bodily health +2 (55,000gp)'''),
    (19, '''Manual of gainful exercise +2 (55,000gp)'''),
    (23, '''Manual of quickness of action +2 (55,000gp)'''),
    (27, '''Tome of clear thought +2 (55,000gp)'''),
    (31, '''Tome of leadership and influence +2 (55,000gp)'''),
    (35, '''Tome of understanding +2 (55,000gp)'''),
    (36, '''Lord's banner (terror) (56,000gp)'''),
    (37, '''Carpet of flying (10 ft. by 10 ft.) (60,000gp)'''),
    (39, '''Darkskull (60,000gp)'''),
    (40, '''Orb of pure law (60,000gp)'''),
    (41, '''Cube of force (62,000gp)'''),
    (43, '''Page of spell knowledge (8th) (64,000gp)'''),
    (49, '''Pearl of Power (8th) (64,000gp)'''),
    (50, '''Crystal ball with telepathy (70,000gp)'''),
    (51, '''Horn of blasting (greater) (70,000gp)'''),
    (54, '''Pearl of Power (two spells) (70,000gp)'''),
    (55, '''Gem of seeing (75,000gp)'''),
    (56, '''Lord's banner (victory) (75,000gp)'''),
    (57, '''Crystal ball with true seeing (80,000gp)'''),
    (59, '''Page of spell knowledge (9th) (81,000gp)'''),
    (62, '''Pearl of Power (9th) (81,000gp)'''),
    (63, '''Well of many worlds (82,000gp)'''),
    (65, '''Manual of bodily health +3 (82,500gp)'''),
    (67, '''Manual of gainful exercise +3 (82,500gp)'''),
    (69, '''Manual of quickness of action +3 (82,500gp)'''),
    (71, '''Tome of clear thought +3 (82,500gp)'''),
    (73, '''Tome of leadership and influence +3 (82,500gp)'''),
    (75, '''Tome of understanding +3 (82,500gp)'''),
    (76, '''Apparatus of the crab (90,000gp)'''),
    (77, '''Bowl of conjuring water elementals (90,000gp)'''),
    (78, '''Brazier of conjuring fire elementals (90,000gp)'''),
    (79, '''Censer of conjuring air elementals (90,000gp)'''),
    (80, '''Stone of conjuring earth elementals (90,000gp)'''),
    (81, '''Mirror of opposition (92,000gp)'''),
    (82, '''Strand of prayer beads (greater) (95,800gp)'''),
    (83, '''Lord's banner (crusades) (100,000gp)'''),
    (84, '''Manual of bodily health +4 (110,000gp)'''),
    (85, '''Manual of gainful exercise +4 (110,000gp)'''),
    (86, '''Manual of quickness of action +4 (110,000gp)'''),
    (87, '''Tome of clear thought +4 (110,000gp)'''),
    (88, '''Tome of leadership and influence +4 (110,000gp)'''),
    (89, '''Tome of understanding +4 (110,000gp)'''),
    (90, '''Manual of bodily health +5 (137,500gp)'''),
    (91, '''Manual of gainful exercise +5 (137,500gp)'''),
    (92, '''Manual of quickness of action +5 (137,500gp)'''),
    (93, '''Tome of clear thought +5 (137,500gp)'''),
    (94, '''Tome of leadership and influence +5 (137,500gp)'''),
    (95, '''Tome of understanding +5 (137,500gp)'''),
    (96, '''Efreeti bottle (145,000gp)'''),
    (97, '''Cubic gate (164,000gp)'''),
    (98, '''Iron flask (170,000gp)'''),
    (99, '''Mirror of mental prowess (175,000gp)'''),
    (100, '''Mirror of life trapping (200,000gp)'''),
    ]

slots = [
    (6, 'Belt'),
    (12, 'Body'),
    (17, 'Chest'),
    (22, 'Eye'),
    (28, 'Feet'),
    (34, 'Hand'),
    (41, 'Head'),
    (47, 'Headband'),
    (54, 'Neck'),
    (61, 'Shoulder'),
    (67, 'Wrist'),
    (100, 'Slotless'),
    ]


def wondernator(type):
    def inner():
        slot = roll(slots)
        lchart = globals()['l%s_%s' % (type, slot.lower())]
        gchart = globals()['g%s_%s' % (type, slot.lower())]
        return recurse(zip((66, 100), (lchart, gchart)))
    return inner

wondrous = (
        wondernator('min'),
        wondernator('med'),
        wondernator('maj'),
        )


def roll(chart):
    '''Given (d100, v1, v2, vN) chart return v1, v2, vN matching roll.'''
    d100 = random.randint(1, 100)
    for r, v in chart:
        if d100 <= r:
            return v


def recurse(result):
    if callable(result):
        return recurse(result())
    else:
        try:
            return recurse(roll(result))
        except ValueError:
            return result


def corerule(index, chart):
    return recurse(roll(chart)[index])


RE_GP = re.compile(r'^(.+)\s*\(([,0-9]+)\s*(gp)\)\s*("?)(.*)')


def gp_extract(text):
    match = RE_GP.match(text)
    gp = ''
    if match:
        gp = '%s %s' % (match.group(2), match.group(3))
        text = match.group(1).strip() + match.group(4) + match.group(5)
    return gp, custom_capitalize(text)


def custom_capitalize(text):
    words = list()
    for word in text.strip().split():
        if not word.startswith('"') and word.lower() not in ('a', 'and', 'any', 'in', 'of', 'the', 'with', 'one', 'two', 'three', 'four', 'ii"', 'iii"', 'iv"', 'vi"', 'vii"', 'viii"', 'ix"'):
            word = word.capitalize()
        words.append(word)
    return ' '.join(words)


def get_func(type, args):
    '''returns: list of funcs (use random.choice) and count.'''
    def parse(args, sublevels, mainlevels):
        def get(arg, options):
            for option in options:
                if option.startswith(arg):
                    return option
        sub = None
        main = None
        count = 1
        for arg in args:
            if sub is None:
                sub = get(arg, sublevels)
            if main is None:
                main = get(arg, mainlevels)
            try:
                count = int(arg)
            except ValueError:
                pass
        return sub, main, count
    sublevels = ['lessor', 'lesser', 'greater']
    mainlevels = ['minor', 'medium', 'major']
    sub, main, count = parse(args, sublevels, mainlevels)
    plural = ['', 's'][count > 1]
    if sub and main:
        print '%i %s %s %s%s' % (count, sub, main, type, plural)
        funcs = [globals()['%s%s_%s' % (sub[0], main[:3], type)], ]
    elif main:
        print '%i %s %s%s' % (count, main, type, plural)
        funcs = [globals()[type][mainlevels.index(main)], ]
    else:
        print '%i %s%s' % (count, type, plural)
        funcs = globals()[type]
    return funcs, count


def action_maker(type, spell_levels=[]):
    def inner(self):
        funcs, count = get_func(type, self.config.args)
        if spell_levels and self.config.spelllevel is not None:
            level = spell_levels[int(self.config.spelllevel)]
            treasures = [('', recurse(level)) for x in range(count)]
        else:
            treasures = [('', recurse(random.choice(funcs))) for x in range(count)]
        self._print(treasures)
    inner.doc = '''Random %s''' % type
    return inner


class TreasureApp(app.App):
    '''Pathfinder RPG treasure generation.'''
    VERSION = '1.0.0'

    master = (armor, weapon, potion, ring, rod, scroll, staff, wand, wondrous)
    charts = (
            zip((4, 9, 44, 46, 0, 81, 0, 91, 100), master),
            zip((10, 20, 30, 40, 50, 65, 68, 83, 100), master),
            zip((10, 20, 25, 35, 45, 55, 75, 80, 100), master),
            )
    lables = ('Minor', 'Medium', 'Major')

    def init_parser(self):
        def gpsort(x):
            try:
                bits = x.split()
                return int(bits[0].replace(',', '')), bits[1:]
            except Exception as e:
                return x
        self.formaters = dict()
        self.formaters['base'] = (lambda l, t: '%-12s %s' % gp_extract(t), gpsort)
        self.formaters['bore'] = (lambda l, t: custom_capitalize(t), lambda x: x)
        self.formaters['type'] = (lambda l, t: '%-7s - %s' % (l, custom_capitalize(t)), lambda x: x)
        self.formaters['rst'] = self.formaters['base']

        super(TreasureApp, self).init_parser(description=__doc__)
        self.actions.choices['market'].add_argument('minor', metavar='<minor>', type=int)
        self.actions.choices['market'].add_argument('medium', metavar='<medium>', type=int)
        self.actions.choices['market'].add_argument('major', metavar='<major>', type=int)
        self.actions.choices['minor'].add_argument('count', metavar='<count>', nargs='?', default=1, type=int)
        self.actions.choices['medium'].add_argument('count', metavar='<count>', nargs='?', default=1, type=int)
        self.actions.choices['major'].add_argument('count', metavar='<count>', nargs='?', default=1, type=int)
        self.actions.choices['armor'].add_argument('args', metavar='<arg>', nargs='*')
        self.actions.choices['weapon'].add_argument('args', metavar='<arg>', nargs='*')
        self.actions.choices['potion'].add_argument('args', metavar='<arg>', nargs='*')
        self.actions.choices['ring'].add_argument('args', metavar='<arg>', nargs='*')
        self.actions.choices['rod'].add_argument('args', metavar='<arg>', nargs='*')
        self.actions.choices['scroll'].add_argument('args', metavar='<arg>', nargs='*')
        self.actions.choices['staff'].add_argument('args', metavar='<arg>', nargs='*')
        self.actions.choices['wand'].add_argument('args', metavar='<arg>', nargs='*')
        self.actions.choices['wondrous'].add_argument('args', metavar='<arg>', nargs='*')
        self.actions.choices['misc'].add_argument('args', metavar='<arg>', nargs='*')
        self.cmdline.add_argument('-f', '--format', default='base', choices=self.formaters.keys())
        self.cmdline.add_argument('-s', '--sort', action='store_true', default=False)
        self.cmdline.add_argument('-l', '--spelllevel', default=None)

    def _print(self, treasures):
        '''Output list of treasures according to formating and sorting style selected.'''
        styler, sorter = self.formaters[self.config.format]
        if self.config.format == 'rst':  # ReSTructured text
            table = '%s %s' % ('=' * 12, '=' * 60)
            print table
            print 'Cost         Item'
            print table
        output = list()
        for treasure in treasures:
            output.append(styler(*treasure))
        if self.config.sort:
            output.sort(key=sorter)
        print '\n'.join(output)
        if self.config.format == 'rst':
            print table

    def _core(self, minor, medium, major):
        '''Produce a number of minor, medium and major magic items.'''
        counts = (minor, medium, major)
        treasures = list()
        for name, index, chart, count in zip(self.lables, range(3), self.charts, counts):
            for i in range(count):
                treasures.append((name, corerule(index, chart)))
        return treasures

    def action_market(self):
        '''ReSTructured Text formated block of items found in market.'''
        self.config.format = 'rst'
        self._print(self._core(self.config.minor, self.config.medium, self.config.major))

    def action_minor(self):
        '''Random minor item.'''
        self._print(self._core(self.config.count, 0, 0))

    def action_medium(self):
        '''Random medium item.'''
        self._print(self._core(0, self.config.count, 0))

    def action_major(self):
        '''Random major item.'''
        self._print(self._core(0, 0, self.config.count))

    action_armor = action_maker('armor')
    action_weapon = action_maker('weapon')
    action_potion = action_maker('potion', [p0, p1, p2, p3])
    action_ring = action_maker('ring')
    action_rod = action_maker('rod')
    action_scroll = action_maker('scroll', [s0, s1, s2, s3, s4, s5, s6, s7, s8, s9])
    action_staff = action_maker('staff')
    action_wand = action_maker('wand', [w0, w1, w2, w3, w4])
    action_wondrous = action_maker('wondrous')
    action_misc = action_wondrous


if __name__ == '__main__':
    TreasureApp().run()
